{% extends 'base.html' %}
{% load humanize %}
{% load static %}
{% block context %}
    <script src="https://cdn.jsdelivr.net/gh/linways/table-to-excel@v1.0.4/dist/tableToExcel.js"></script>
    {% include 'message.html' %}
    <div class="main-container>">
        <div class="card">
            <h2>  حقوق و دستمزد پشتیبان منطقه</h2>
            <br>
            <form action="" method="post">
                {% csrf_token %}
                <div class="row">

{#                    <div class="col-lg-1 col-md-1 col-sm-1"></div>#}
                    <div class="col-lg-2 col-md-2 col-sm-12">
                        <label>انتخاب ماه</label>
                    </div>

                    <div class="col-lg-4 col-md-4 col-sm-12">
                        <select name="period" id="id_period" class="form-control">
                            <option value="0">دوره مورد نظر را انتخاب کنید</option>
                            {% for mon in mounts %}
                                <option {% if mon.id == period %}selected{% endif %}
                                        value="{{ mon.id }}">{{ mon.mount }} </option>
                            {% endfor %}
                        </select>
                    </div>


        <button type="submit" class="btn btn-success">مشاهده</button>    </div>

            </form>
                    <div class="col-lg-12 col-md-12 col-sm-12">

             <div class="table-responsive">
        <table id="listpayTable" class="table table-striped">
         <caption style="display: none">وضعیت منطقه</caption>
                             <thead>
 <button id="exportBtn1" style="color: #fffbff" class="btn nav-link bg-info" title="ارسال به اکسل ">
                <i data-feather="send" aria-hidden="true"></i>ارسال به اکسل
            </button>
                             </thead>
                                <thead>
                                <tr>
                                    <th scope="col">ردیف </th>
                                    <th scope="col">نام </th>
                                     <th scope="col"  class="text-center" >وضعیت</th>
                                     <th scope="col"  class="text-center" >تایید مدیر</th>
                                     <th scope="col"  class="text-center" >تعداد قرارداد</th>
                                     <th scope="col"  class="text-center" >تعداد نفرات در سامانه</th>
                                     <th scope="col"  class="text-center" >تایید ثبت شده</th>
                                     <th scope="col"  class="text-center" >کسری</th>
                                     <th scope="col"  class="text-center" >...</th>
                                    {% if formpermmision.okmgr != 'no' %}
                                     <th scope="col"  class="text-center" >...</th>
                                    {% endif %}

                                </tr>
                                </thead>

                                <tbody>
                                {% for list in thislist %}
                                    <tr>
                                        <td>{{ forloop.counter }}</td>
                                        <td>{{ list.zone }}</td>
                                       <td style="background: {% if list.status == 1 %} #68ff35{% endif %} {% if list.status == 2 %} #fffa35{% endif %}{% if list.status == 3 %} #ff5a35{% endif %}{% if list.status == 4 %} #ff5f58{% endif %};color: #090909" class="text-center" >{{ list.desc }}</td>
                                        <td {% if list.ac == 'تایید نشده' %} style="background: #ffd1be; color: #0b0b0b" {% endif %}>{{ list.ac }}
                                        <td>{{ list.isok }}</td>
                                        <td>{{ list.owner }}</td>
                                        <td>{{ list.sabt }}</td>
                                    {% if list.kasri == 0 %}
                                        <td></td>
                                    {% else %}
                                        <td>{{ list.kasri }}</td>
                                    {% endif %}
                                        </td>
<td><a class="btn btn-outline-success" href="{% url "pay:DastmozdToExcel" period list.zone_id  %}">ارسال با اکسل</a> </td>
                                    {% if formpermmision.okmgr != 'no' %}
<td><a class="btn btn-outline-success" href="{% url "pay:accesptmgr2" period list.zone_id  %}">تایید حقوق</a> </td>
                                    {% endif %}
                                    </tr>
                                {% endfor %}
<tfoot style="background: #12faff; color: #0b0b0b">
                                                  <td></td>
                                        <td style="width: 40%"></td>
                                       <td></td>
                                <td>جمع کل</td>
                                        <td>{{ sumzone }}</td>
                                        <td>{{ sumowner }}</td>
                                        <td>{{ sumlist }}</td>
                                        <td>{{ sumkasri }}</td>
                                        <td></td>
                                </tfoot>
                            </table>

                        </div>

<div class="row">
    <div class="col-5"></div>
    <div class="col-4">
  <a style="color: #fbfdff" href="{% url 'pay:DastmozdToExcel' period 0 %}" class="btn btn-warning">خروجی اکسل حقوق همه تکنسین ها</a>
  <a style="color: #fbfdff" href="{% url 'pay:tadiltoexcel' period 0 %}" class="btn btn-primary">خروجی اکسل تعدیل همه تکنسین ها</a>
    </div>
     <div class="col-3"></div>
    <br>
    <br>
    </div>

                    </div>

        </div>

    </div>
{% endblock %}
{% block script %}
            <script type="text/javascript">
  $(document).ready(function () {
      $("#exportBtn1").click(function(){
        TableToExcel.convert(document.getElementById("myTable"), {
            name: "list.xlsx",
            sheet: {
            name: "Sheet1"
            }
          });
        });
  });
</script>
{% endblock %}