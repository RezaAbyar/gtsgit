{% extends 'base.html' %}
{% load humanize %}
{% load static %}
{% load jalali_tags %}
{% block css %}

    <style>
        thead,
        tfoot {
            background-color: #3f87a6;
            color: #fff;
        }
    </style>

{% endblock %}
{% block context %}
    <script src="https://cdn.jsdelivr.net/gh/linways/table-to-excel@v1.0.4/dist/tableToExcel.js"></script>
        <link type="text/css" rel="stylesheet" href="{% static 'assets/css/jalalidatepicker.min.css' %} " />
<script type="text/javascript" src="{% static 'assets/js/jalalidatepicker.min.js' %}"></script>
        {% include 'message.html' %}
    <div class="col-lg-12 col-md-12 col-sm-12">

        <div class="card">
            <div class="card-body">

        <ul class="nav">
            <div class="row">
                <div class="container">
                    <div class="col-12">
                        <h3 class="c-center c-font-uppercase c-font-bold"> گزارش منطقه {{ zone }}
                            <button id="exportBtn1" class="btn btn-warning">ارسال به اکسل</button>
                         </h3>


                    </div>
                </div>
            </div>
        </ul>

        <div class="row">
            <div class="col-lg-12">
                <div class="table-responsive">
                    <table id="myTable" class="table table-striped table-bordered">
                     <caption style="display: none">گزارش مدیریتی</caption>
                    <thead>

                    </thead>

                        <tr style="background: #ececec; color: #0b0b0b">
                            <th scope="col">#</th>
                            <th class="align-middle text-center text-sm" scope="col">شماره سریال</th>
                            <th class="align-middle text-center text-sm" scope="col">نام منطقه</th>
                            <th class="align-middle text-center text-sm" scope="col">نوع قطعه</th>
                            <th class="align-middle text-center text-sm" scope="col">تاریخ ارسال مرسوله</th>
                            <th class="align-middle text-center text-sm" scope="col"> تاریخ رسید مرسوله</th>
                            <th class="align-middle text-center text-sm" scope="col">تاریخ نصب در جایگاه </th>
                             <th class="align-middle text-center text-sm" scope="col">تاریخ داغی </th>
                             <th class="align-middle text-center text-sm" scope="col">توضیحات </th>
                            <th class="align-middle text-center text-sm" scope="col"> مقدار کارکرد</th>


                        </tr>


                        <tbody>

                        {% for lists in list %}
                            <tr>
                                 <th scope="col"  class="align-middle text-center text-sm"
                                    scope="row">{{ forloop.counter }}</th>

                                <td class="align-middle text-center text-sm">{{ lists.store.serial }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.owner.zone.name }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.store.statusstore.name }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.senddate|to_jalali:'%Y/%m/%d' }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.residdate|to_jalali:'%Y/%m/%d'  }}</td>
                                 <td  class="align-middle text-center text-sm">{{ lists.installdate|to_jalali:'%Y/%m/%d'  }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.create|to_jalali:'%Y/%m/%d'  }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.description }}</td>
                                {% if lists.activeclass in 'A,B' %}
                                <td class="align-middle text-center text-sm">از ابتدا معیوب</td>
                                {% else %}
                                <td class="align-middle text-center text-sm">{{ lists.activeday }} روز </td>
                                {% endif %}

                            </tr>
                        {% endfor %}
                        </tbody>
                        <tfoot>


                        </tfoot>
                    </table>


                </div>
            </div>
        </div>
    </div></div>

    <script>
        $('#btnid').click(function () {
            var x = document.getElementById("filter_id");
            if (window.getComputedStyle(x).display === "none") {

                document.getElementById('filter_id').style.display = 'block';

            } else {
                document.getElementById('filter_id').style.display = 'none';
            }
        });
        $('#btnid2').click(function () {

            document.getElementById('filter_id').style.display = 'none';
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#exportBtn1").click(function () {
                TableToExcel.convert(document.getElementById("tab1"), {
                    name: "Movazene.xlsx",
                    sheet: {
                        name: "Sheet1"
                    }
                });
            });
        });
    </script>
{% endblock %}

{% block script %}
     <script type="text/javascript">
        $(document).ready(function () {

            $("#exportBtn1").click(function () {
                TableToExcel.convert(document.getElementById("myTable"), {
                    name: "GSInfo.xlsx",
                    sheet: {
                        name: "Sheet1"
                    }
                });
            });
        });
    </script>
{% endblock %}
