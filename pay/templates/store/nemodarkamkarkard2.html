{% extends 'base.html' %}
{% load static %}
{% load jalali_tags %}
{% block title %}گزارش فروش{% endblock %}
{% block context %}


        <link type="text/css" rel="stylesheet" href="{% static 'assets/css/jalalidatepicker.min.css' %} "/>
        <script type="text/javascript" src="{% static 'assets/js/jalalidatepicker.min.js' %}"></script>
        <link rel="stylesheet" href="{% static 'vendors/select2/css/select2.min.css' %}" type="text/css">
        <script src="{% static 'assets/js/jquery-3.5.1.min.js' %}"></script>
        <!-- begin::container -->

            <form action="" method="post">
                {% csrf_token %}
                <div class="page-header">
                    <h4>گزارش قطعات ارسالی کارگاه و تعداد کم کارکرد  </h4>
                    <small class="">
                        <div class="row">
                            <div class="col-lg-3 col-md-3 col-sm-12">
                                <input required data-jdp type="text" name="select" id="select" value="{{ az }}"
                                       class="form-control" placeholder="تاریخ گزارش از" autocomplete="off">
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-12">
                                <input required data-jdp type="text" name="select2" id="select2" value="{{ ta }}"
                                       class="form-control" placeholder="تاریخ گزارش تا" autocomplete="off">
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-12">


                                <select name="storage" id="id_storage" class="form-control">
                                    {% for item in storages %}
                                        <option {% if item.id == storagesid %} selected {% endif %}
                                                                         value={{ item.id }}>{{ item.name }}</option>
                                    {% endfor %}
                                </select>

                            </div>



                            <div class="col-lg-2 col-md-2 col-sm-12">
                                <button type="submit" class="btn btn-warning c-btn-uppercase">گزارش</button>
                            </div>
                        </div>
                        <span class="text-primary"></span></small>
                </div>
            </form>
            <div class="row">
                <div class="col-md-12">


                    <div class="row">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-title d-flex justify-content-between">
                                        <span>گزارش </span>
                                        <span class="dropdown primary-font">
                                            <a class="pl-2 pr-2" href="#" data-toggle="dropdown" aria-haspopup="true"
                                               aria-expanded="false">
                                                <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
                                            </a>
{#											<span class="dropdown-menu dropdown-menu-right">#}
{#                                                <a href="?n=area" class="dropdown-item">بر اساس ماه</a>#}
{#                                                <a href="?n=tek" class="dropdown-item">گزارش روزانه</a>#}
{##}
{##}
{#                                            </span>#}
                                        </span>
                                    </h6>
                                    <div id="chart1"></div>
                                </div>
                            </div>
                        </div>
                    </div>



{#    <div class="card">#}
{#        <div class="card-body">#}
{#            <div class="table-responsive">#}
{#                    <table id="tab1" class="table align-items-center mb-0">#}
{# <caption style="display: none">گزارش فروش</caption>#}
{#                        <tr>#}
{#                            <th scope="col" class="align-middle text-center text-sm">#</th>#}
{#                            <th class="align-middle text-center text-sm" scope="col">شماره سریال قطعه</th>#}
{#                            <th class="align-middle text-center text-sm" scope="col"> تاریخ ارسال</th>#}
{#                            <th class="align-middle text-center text-sm" scope="col"> تاریخ رسید</th>#}
{#                            <th class="align-middle text-center text-sm" scope="col"> تاریخ نصب</th>#}
{#                            <th class="align-middle text-center text-sm" scope="col"> تاریخ داغی</th>#}
{#                            <th class="align-middle text-center text-sm" scope="col"> کارکرد</th>#}
{#                            <th class="align-middle text-center text-sm" scope="col">تکنسین</th>#}
{#                            <th class="align-middle text-center text-sm" scope="col"></th>#}
{#                            <th class="align-middle text-center text-sm" scope="col">منطقه</th>#}
{##}
{##}
{##}
{##}
{#                        </tr>#}
{##}
{##}
{#                        <tbody>#}
{#                        {% for lists in list %}#}
{#                            <tr>#}
{#                                <th class="align-middle text-center text-sm"#}
{#                                    scope="row">{{ forloop.counter }}</th>#}
{#                                <td class="align-middle text-center text-sm">{{ lists.serial }}</td>#}
{##}
{#                                <td class="align-middle text-center text-sm">{{ lists.senddate|to_jalali:'%Y/%m/%d' }}</td>#}
{#                                <td class="align-middle text-center text-sm">{{ lists.residdate|to_jalali:'%Y/%m/%d' }}</td>#}
{#                                <td class="align-middle text-center text-sm">{{ lists.installdate|to_jalali:'%Y/%m/%d' }}</td>#}
{#                                <td class="align-middle text-center text-sm">{{ lists.create|to_jalali:'%Y/%m/%d' }}</td>#}
{#                                <td class="align-middle text-center text-sm">{% if lists.starterror %} از ابتدا معیوب {% else %} {{ lists.activeday }}{% endif %}</td>#}
{#                                <td class="align-middle text-center text-sm">{{ lists.owner }} </td>#}
{#                                <td class="align-middle text-center text-sm">{{ lists.description }} </td>#}
{##}
{#                                <td class="align-middle text-center text-sm">{{ lists.owner.zone.name }}</td>#}
{##}
{##}
{##}
{#                            </tr>#}
{#                        {% endfor %}#}
{#                        </tbody>#}
{#                        <tfoot>#}
{##}
{##}
{##}
{#                    </table>#}
{#        </div>#}
{#    </div>#}
{#</div>#}


            </div>
        </div>
            </div>


    <script>

        'use strict';
        $(document).ready(function () {
            jalaliDatepicker.startWatch();
            $('.select2-example').select2({
                placeholder: 'همه مناطق',
                allowClear: true
            });
            var colors = {
                primary: $('.colors .bg-primary').css('background-color'),
                primaryLight: $('.colors .bg-primary-bright').css('background-color'),
                secondary: $('.colors .bg-secondary').css('background-color'),
                secondaryLight: $('.colors .bg-secondary-bright').css('background-color'),
                info: $('.colors .bg-info').css('background-color'),
                infoLight: $('.colors .bg-info-bright').css('background-color'),
                success: $('.colors .bg-success').css('background-color'),
                successLight: $('.colors .bg-success-bright').css('background-color'),
                danger: $('.colors .bg-danger').css('background-color'),
                dangerLight: $('.colors .bg-danger-bright').css('background-color'),
                warning: $('.colors .bg-warning').css('background-color'),
                warningLight: $('.colors .bg-warning-bright').css('background-color'),
            };














          function chart1() {
                if ($('#chart1').length > 0) {

                    Apex.chart = {
                        fontFamily: 'inherit',
                        locales: [{
                            "name": "fa",

                        }],
                        defaultLocale: "fa"
                    }

                    var modeltype;

                    modeltype = 'bar'

                    var options = {
                        chart: {
                            height: 375,
                            type: modeltype,
                            toolbar: {
                                show: true
                            }
                        },
                        plotOptions: {
                            bar: {
                                horizontal: false,
                                columnWidth: '55%',
                                endingShape: 'rounded'
                            },
                        },
                        dataLabels: {
                            enabled: true,
                           textAnchor: "start",
                        textalign: "end",
                        },
                        stroke: {
                            show: true,
                            width: 2,

                        },
                        series: [{
                            name: 'قطعات تعمیر شده',
                            data: [{% for item in nemodar1 %} {{ item.send }} ,{% endfor %}]
                        },{
                            name: 'زیر 30 روز کارکرد',
                            data: [{% for item in nemodar1 %} {{ item.val }} ,{% endfor %}]
                        }],
                        xaxis: {
                            categories: [{% for item in nemodar1 %} '{{ item.date }}' ,{% endfor %}]
                        },
                        fill: {
                            opacity: 2

                        },
                        tooltip: {
                            y: {
                                formatter: function (val) {
                                    return val + " قطعه "
                                }
                            }
                        }
                    };

                    var chart = new ApexCharts(
                        document.querySelector("#chart1"),
                        options
                    );

                    chart.render();
                }
            }

            chart1();

        });


    </script>

    {% block script %}


        {#    <script src="{% static 'assets/js/examples/dashboard.js' %}"></script>#}

        <script src="{% static 'vendors/charts/chartjs/chart.min.js' %}"></script>

        <!-- Apex chart -->
        <script src="{% static 'vendors/charts/apex/apexcharts.min.js' %}"></script>

        <!-- Circle progress -->
        {#<script src="{% static 'vendors/circle-progress/circle-progress.min.js' %}"></script>#}

        <!-- Peity -->
{#        <script src="{% static 'vendors/charts/peity/jquery.peity.min.js' %}"></script>#}
{#        <script src="{% static 'assets/js/examples/charts/peity.js' %}"></script>#}

        <!-- Datepicker -->
        <script src="{% static 'vendors/datepicker/daterangepicker.js' %}"></script>
    {% endblock %}
{% endblock %}

