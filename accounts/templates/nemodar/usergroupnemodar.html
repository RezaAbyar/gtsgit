{% extends 'base.html' %}
{% load humanize %}
{% load static %}

{% block css %}

    <style>
        thead,
        tfoot {
            background-color: #3f87a6;
            color: #fff;
        }
    </style>


{% endblock %}
{% block context %}
    <link type="text/css" rel="stylesheet" href="{% static 'assets/css/jalalidatepicker.min.css' %} "/>
    <script type="text/javascript" src="{% static 'assets/js/jalalidatepicker.min.js' %}"></script>
      <script src="/static/assets/js/jquery-3.5.1.min.js"></script>
    {% include 'message.html' %}


    <div class="card">
        <div class="card-body">

            <ul class="nav">
                <div class="row">

                    <div class="col-12">
                        <h3 class="c-center c-font-uppercase c-font-bold">رویداد کاربران
                        </h3>
                        <hr>
                    </div>
                </div>
            </ul>
            <form action="" method="post">
                {% csrf_token %}
                <div class="row">
                    <div class="col-lg-4 col-md-4 col-sm-12">

                        <select name="select3" onclick="$(this).select()"

                                class="select2-example form-control">
                            <option value="0">همه</option>
                            {% for gs in refs %}
                                <option {% if gs.id == ownerid %} selected {% endif %} value="{{ gs.id }}"
                                >{{ gs.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-12">
                        <input required data-jdp type="text" name="select" id="select" value="{{ az }}"
                               class="form-control" placeholder="تاریخ" autocomplete="off">
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-12">
                        <input required data-jdp type="text" name="select2" id="select2" value="{{ ta }}"
                               class="form-control" placeholder="تاریخ" autocomplete="off">
                    </div>
                    <div class="col-lg-2 col-md-2 col-sm-12">
                        <button type="submit" class="btn btn-warning c-btn-uppercase">گزارش</button>
                    </div>
                </div>
            </form>

        </div>
    </div>
    <div class="card">
        <div class="card-body">

                <h6 class="card-title d-flex align-items-start justify-content-between mb-0">


                        <span>نمودار رویداد کاربران بر اساس سمت ها</span>
                    <span class="dropdown primary-font">
                                            <a class="pl-2 pr-2" data-toggle="modal" data-target="#zommrep2"
                                               aria-haspopup="true"
                                               aria-expanded="false">

                                            </a>
                                        </span>
                </h6>
                <div id="top_10_zone_small"></div>
            </div>
        </div>
    </div>


        <script src="/static/vendors/charts/chartjs/chart.min.js"></script>

        <!-- Apex chart -->
        <script src="/static/vendors/charts/apex/apexcharts.min.js"></script>


    <script>

 jalaliDatepicker.startWatch();
    $(document).ready(function () {

        var colors = {
            primary: $('.colors .bg-primary').css('background-color'),
            primaryLight: $('.colors .bg-primary-bright').css('background-color'),
            secondary: $('.colors .bg-secondary').css('background-color'),
            secondaryLight: $('.colors .bg-secondary-bright').css('background-color'),
            info: $('.colors .bg-info').css('background-color'),
            infoLight: $('.colors .bg-info-bright').css('background-color'),
            success: $('.colors .bg-success').css('background-color'),
            successLight: $('.colors .bg-success-bright').css('background-color'),
            danger: $('.colors .bg-danger').css('background-color'),
            dangerLight: $('.colors .bg-danger-bright').css('background-color'),
            warning: $('.colors .bg-warning').css('background-color'),
            warningLight: $('.colors .bg-warning-bright').css('background-color'),
        };

        var chartColors = {
            primary: {
                base: '#3f51b5',
                light: '#c0c5e4'
            },
            danger: {
                base: '#f2125e',
                light: '#fcd0df'
            },
            success: {
                base: '#0acf97',
                light: '#cef5ea'
            },
            warning: {
                base: '#ff8300',
                light: '#ffe6cc'
            },
            info: {
                base: '#00bcd4',
                light: '#e1efff'
            },
            dark: '#37474f',
            facebook: '#3b5998',
            twitter: '#55acee',
            linkedin: '#0077b5',
            instagram: '#517fa4',
            whatsapp: '#25D366',
            dribbble: '#ea4c89',
            google: '#DB4437',
            borderColor: '#e8e8e8',
            fontColor: '#999'
        };

        if ($('body').hasClass('dark')) {
            chartColors.borderColor = 'rgba(255, 255, 255, .1)';
            chartColors.fontColor = 'rgba(255, 255, 255, .4)';
        }




                function top_10_zone_small() {
            if ($('#top_10_zone_small').length > 0) {

                Apex.chart = {
                    fontFamily: 'inherit',
                    locales: [{
                        "name": "en",

                    }],
                    defaultLocale: "en"
                }

                var options = {
                    chart: {
                        height: 250,
                        type: 'bar',
                        toolbar: {
                            show: false
                        }
                    },
                    plotOptions: {
                        bar: {
                            horizontal: false,
                            columnWidth: '55%',
                            endingShape: 'rounded'
                        },
                    },
                    dataLabels: {
                        enabled: false
                    },
                    stroke: {
                        show: true,
                        width: 2,
                        colors: ['transparent']
                    },
                    series: [{
                        name: '',
                        data: [{% for item in list %} {{ item.count }} ,{% endfor %}]
                    },],
                    xaxis: {
                        categories: [{% for item in list %} '{{ item.owner__name }} {{ item.owner__lname }} {{ item.owner__role__name }} - {{ item.owner__refrence__name }}' ,{% endfor %}]
                    },
                    fill: {
                        opacity: 1,
                        colors: ['#4bb944', '#9df64a', '#186c12']

                    },
                    tooltip: {
                        y: {
                            formatter: function (val) {
                                return val + "  رویداد  "
                            }
                        }
                    }
                };

                var chart = new ApexCharts(
                    document.querySelector("#top_10_zone_small"),
                    options
                );

                chart.render();
            }
        }

        top_10_zone_small();
                 });

</script>
{% endblock %}