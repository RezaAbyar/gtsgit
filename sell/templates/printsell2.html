<!DOCTYPE html>
{% load humanize %}
{% load static %}
<link rel="stylesheet" href="{% static 'assets/css/bootstrap-icons.min.css' %}">
<html lang="fa" dir="rtl">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keyword" content="">
    <style>
        @media print {
            .no-print {
                visibility: hidden;
            }
        }
    </style>
    <title>Ú†Ø§Ù¾ ÙØ±ÙˆØ´</title>
    {% include 'headers2.html' %}
    {% include 'message.html' %}

<style>
    @media print {
        @page {
            size: A4 landscape;
            margin: 10mm;
        }

        body {
            width: 297mm !important;
            height: 210mm !important;
            margin: 0 !important;
            padding: 5mm !important;
            font-size: 10pt !important;
            line-height: 1.3 !important;
            transform: scale(0.95);
            transform-origin: top right;
        }

        .panel-body {
            width: 100% !important;
            margin: 0 !important;
            padding: 0 !important;
        }

        .table-responsive {
            overflow: visible !important;
            width: 100% !important;
        }

        .table {
            width: 100% !important;
            font-size: 8pt !important;
            table-layout: fixed !important;
        }

        .table td, .table th {
            padding: 2px 3px !important;
            word-wrap: break-word !important;
            font-size: 8pt !important;
        }

        /* Ú©Ø§Ù‡Ø´ Ø¹Ø±Ø¶ Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ */


        /* Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ ØºÛŒØ±Ø¶Ø±ÙˆØ±ÛŒ */
        .no-print, .modal, .btn, .bi, [data-feather],
        .form-group, .nav, .modal-footer, .modal-header {
            display: none !important;
        }

        /* Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø´Ú©Ø³ØªÙ† ØµÙØ­Ù‡ */
        table {
            page-break-inside: auto !important;
        }
        tr {
            page-break-inside: avoid !important;
            page-break-after: auto !important;
        }
        thead {
            display: table-header-group !important;
        }

        /* Ú©Ø§Ù‡Ø´ ÙØ§ØµÙ„Ù‡â€ŒÙ‡Ø§ */
        .row {
            margin-bottom: 3px !important;
        }

        br {
            display: none !important;
        }

        /* Ú©Ø§Ù‡Ø´ Ø³Ø§ÛŒØ² Ù‡Ø¯Ø± */
        h4, .h4 {
            font-size: 10pt !important;
            margin: 2px 0 !important;
        }

        /* Ú©Ø§Ù‡Ø´ padding Ú©Ø§Ù†ØªÛŒÙ†Ø±Ù‡Ø§ */
        .container, .col-1, .col-10, .col-2, .col-8, .col-sm-2, .col-sm-10 {
            padding: 0 5px !important;
            margin: 0 !important;
        }

        #accordion {
            margin: 0 !important;
            padding: 0 !important;
        }
    }

    /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø± */
    @media screen {
        .print-preview {
            width: 297mm;
            height: 210mm;
            border: 1px solid #ccc;
            margin: 20px auto;
            padding: 10mm;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            transform: scale(0.8);
            transform-origin: top center;
        }
    }
</style>



    <script>
        $(window).load(function () {
            // Animate loader off screen
            $(".se-pre-con").fadeOut("slow");
        });
    </script>
</head>

<body>

<div class="panel-body">
    <div id="accordion" style="margin: 20px;">


        <br>
        <br>
        <br>
        <br>
        <br>
        {% csrf_token %}
        <div class="row ">
            <div class="col-1"></div>
            <div class="col-10 ">

                <span> ØªØ§Ø±ÛŒØ® ØªÙ‡ÛŒÙ‡ Ú¯Ø²Ø§Ø±Ø´ {{ today }}</span>
                <div class="table-responsive">
                    <table class="table table-bordered table-hover text-center text-base "
                           style="direction: rtl; margin-top:6px">
                        <caption style="display: none">Ù¾Ø±ÛŒÙ†Øª 1502</caption>
                        <thead>
                        <th scope="col" colspan="2" class="text-center"><img alt="logo"
                                                                             src="{% static 'assets/media/image/logo.png' %}">
                        </th>
                        {% if hdcrash %}
                            <th style="font-size: 20px;" colspan="9" class="text-center">ÙØ±Ù… ØªØ¹ÙˆÛŒØ¶ Ù‡Ø§Ø±Ø¯</th>
                        {% else %}
                            <th style="font-size: 20px;" colspan="9" class="text-center">ÙØ±Ù… 09FM1502</th>
                        {% endif %}
                        <th style="font-size: 14px;" colspan="2" class="text-center">{{ general.name }}</th>
                        <th style="font-size: 15px;" colspan="1" class="text-center"> {{ date }}</th>
                        </thead>
                        <thead>
                        <th scope="col" colspan="1" class="text-center">Ù…Ù†Ø·Ù‚Ù‡ :{{ general.area.zone.name }}</th>
                        <th scope="col" class="text-center">Ù†Ø§Ø­ÛŒÙ‡ :{{ general.area.name }}</th>
                        <th style="font-size: 15px;" colspan="9" class="text-center">Ú¯Ø²Ø§Ø±Ø´ ØªÙØ§ÙˆØª Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡ Ù‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒÚ©ÛŒ Ùˆ
                            Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ
                        </th>
                        <th style="font-size: 20px;" colspan="3" class="text-center">Ú©Ø¯ Ø¬Ø§ÛŒÚ¯Ø§Ù‡ :{{ general.gsid }}</th>
                        </thead>
                        <thead>
                        <tr>

                            <th scope="col" rowspan="2" class="text-center">Ø´Ù…Ø§Ø±Ù‡ Ù†Ø§Ø²Ù„</th>
                            <th scope="col" rowspan="2" class="text-center">ÙØ±Ø¢ÙˆØ±Ø¯Ù‡</th>
                            <th scope="col" colspan="2" class="text-center">Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡ Ù…Ú©Ø§Ù†ÛŒÚ©ÛŒ</th>
                            <th scope="col" colspan="7" class="text-center">ÙØ±ÙˆØ´</th>
                            <th scope="col" colspan="3" class="text-center">Ø§Ø®ØªÙ„Ø§Ù</th>
                        </tr>
                        <input type="hidden" id="sellid">
                        <tr class="vendorListHeading">

                            <th scope="col" class="text-center">Ø´Ù…Ø§Ø±Ù‡ Ø§ÙˆÙ„ ÙˆÙ‚Øª</th>
                            <th scope="col" class="text-center">Ø´Ù…Ø§Ø±Ù‡ Ø¢Ø®Ø± ÙˆÙ‚Øª</th>
                            <th scope="col" class="text-center"> Ù…Ú©Ø§Ù†ÛŒÚ©ÛŒ</th>
                            <th scope="col" class="text-center">Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ

                            </th>
                            <span id="detok">
                                <th style="background-color: #eaeaea" scope="col" class="text-center"> ÛŒØ§Ø±Ø§Ù†Ù‡ Ø§ÛŒÛŒ</th>
                                <th style="background-color: #eaeaea" scope="col" class="text-center"> Ø¢Ø²Ø§Ø¯</th>
                                <th style="background-color: #eaeaea" scope="col" class="text-center"> Ú©Ø§Ø±Øª Ø¬Ø§ÛŒÚ¯Ø§Ù‡</th>
                                <th style="background-color: #eaeaea" scope="col"
                                    class="text-center"> Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒ/Ú©Ù…ÛŒ</th>
                                <th style="background-color: #eaeaea" scope="col" scope="col" class="text-center"> Ú©Ø§Ø±Øª Ø§Ø¶Ø·Ø±Ø§Ø±ÛŒ</th>
                                    </span>
                            <th scope="col" class="text-center"> Ù…Ú©Ø§Ù†ÛŒÚ©ÛŒ Ùˆ Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ</th>
                            <th scope="col" class="text-center"> Ù…Ø¬Ø§Ø²</th>
                            <th scope="col" class="text-center"> ØºÛŒØ±Ù…Ø¬Ø§Ø²</th>


                        </tr>
                        </thead>

                            {% for item in sell %}
                                <tr>


                                    <td style="font-size: 18px;">{{ item.tolombeinfo.number }}
                                        {% if request.user.owner.role.role in 'mgr,zone,area' %}
                                            <a href="#" onclick="systemlog({{ item.id }},{{ item.tolombeinfo_id }})"
                                               data-toggle="modal" data-target="#EventInfo" class="no-print"><i
                                                    data-feather="info"
                                                    aria-hidden="true"></i></a>
                                        {% if item.is_soratjalase %}
                                            <a class="no-print" title="ØªØµÙˆÛŒØ± ØµÙˆØ±ØªØ¬Ù„Ø³Ù‡ " data-toggle="tooltip" href="{{ item.image.url }}"><i class="bi bi-card-image" style="font-weight: bold; font-size: 2rem; color: #ea9e11;"></i> </a>
                                            {% endif %}

                                        {% endif %} </td>
                                    <td>{{ item.product.name }}
                                     </td>
                                    <td {% if item.mogh == 1 %} style="font-size: 18px;background: #f38372"
                                                                data-toggle="tooltip"
                                                                title="Ø´Ù…Ø§Ø±Ù‡ Ø¢Ø®Ø± ÙˆÙ‚Øª Ø±ÙˆØ² Ù‚Ø¨Ù„ : {{ item.moghnumber }}"
                                                                {% else %}style="font-size: 18px;"{% endif %}>{{ item.end|intcomma:False }} {% if item.t_start > 0 %} <br><hr> {{ item.t_start|intcomma:False }} {% endif %}</td>
                                    <td style="font-size: 18px;">{{ item.start|intcomma:False }} {% if item.t_start > 0 %} <br><hr> {{ item.t_end|intcomma:False }} {% endif %}</td>
                                    <td style="font-size: 18px;">{{ item.sell|intcomma:False }}</td>
                                    <td style="font-size: 18px;">{{ item.sellkol|intcomma:False }}
                                    </td>
                                    <td style="background-color: #eaeaea;font-size: 18px;">{{ item.yarane|intcomma:False }}</td>
                                    <td style="background-color: #eaeaea;font-size: 18px;">{{ item.azad|intcomma:False }}</td>
                                    <td style="background-color: #eaeaea;font-size: 18px;">{{ item.ezterari|intcomma:False }}</td>
                                    <td style="background-color: #eaeaea;font-size: 18px;">{{ item.azmayesh|intcomma:False }}</td>
                                    <td style="background-color: #eaeaea;font-size: 18px;">{{ item.haveleh|intcomma:False }}</td>
                                    {% if item.sell > item.sellkol %}
                                        <td style="font-size: 18px;">({{ item.ekhtelaf }})</td>
                                    {% else %}
                                        <td style="font-size: 18px;">{{ item.ekhtelaf }}</td>
                                    {% endif %}
                                    <td style="font-size: 18px;">{{ item.mojaz }}</td>
                                    {% if item.sell > item.sellkol %}
                                        <td style="font-size: 18px;">({{ item.nomojaz }})</td>
                                    {% else %}
                                        <td style="font-size: 18px;">{{ item.nomojaz }}</td>
                                    {% endif %}
 </tr>

                     {% for discrepancy in item.discrepancies.all %}
        {% if discrepancy.status == 'system_approved' %}
<tr>
<td class="text-left" colspan="14">
 Ù…ØºØ§ÛŒØ±Øª  Ù†Ø§Ø²Ù„   {{ discrepancy.sell.pumpnumber }}Ø¨Ø±Ø±Ø³ÛŒ Ùˆ ØªØ§ÛŒÛŒØ¯ Ø´Ø¯  {
{{ discrepancy.reason }}
    }
</td>
</tr>
                            {% endif %}
    {% endfor %}
                                    {% if item.is_change_counter and request.user.owner.role.role in 'area,zone' %}

                                        <tr class="no-print">
    <td colspan="14">
        <form id="form{{ item.id }}" action="{% url 'sell:uploadsoratjalase' item.id %}" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="form-group">
                <input name="image" type="file" id="id_image" class="form-control" required>
            </div>
            <button class="btn btn-success" type="submit">Ø§Ø±Ø³Ø§Ù„ ØµÙˆØ±ØªØ¬Ù„Ø³Ù‡</button>
            <br>
            <br>
        </form>
    </td>
</tr>
                                    {% endif %}

                            {% endfor %}
                        </table>
                </div>


                <br>
                <br>
                <div class="row m-b">
                    <div class="col-sm-2">
                        <div class="pull-right form-group">
                            <label for="factor_description"><strong>Ù…Ù‡Ø± Ùˆ Ø§Ù…Ø¶Ø§ Ø¬Ø§ÛŒÚ¯Ø§Ù‡: </strong></label>
                            <textarea class="form-control" id="factor_description1" name="factor_description1" rows="4"
                                      cols="500" readonly></textarea>
                        </div>
                    </div>
                    <div class="col-sm-10">

                        <div class="table-responsive">
                            <table class="table table-bordered table-hover text-center text-base ">
                                <caption style="display: none">Ú¯Ø²Ø§Ø±Ø´ 1502</caption>
                                <thead>
                                <tr class="vendorListHeading">
                                    <th class="text-center">ÙØ±Ø¢ÙˆØ±Ø¯Ù‡</th>
                                    <th class="text-center">Ù…Ø¬Ù…ÙˆØ¹ ÙØ±ÙˆØ´ Ù…Ú©Ø§Ù†ÛŒÚ©ÛŒ</th>
                                    <th class="text-center"> ÙØ±ÙˆØ´ Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ</th>
                                    <th class="text-center"> ÙØ±ÙˆØ´ ÛŒØ§Ø±Ø§Ù†Ù‡ Ø§ÛŒÛŒ</th>
                                    <th class="text-center"> ÙØ±ÙˆØ´ Ø¢Ø²Ø§Ø¯</th>
                                    <th class="text-center"> ÙØ±ÙˆØ´ Ú©Ø§Ø±Øª Ø¬Ø§ÛŒÚ¯Ø§Ù‡</th>
                                    <th class="text-center"> ÙØ±ÙˆØ´ Ú©Ù†ØªØ±Ù„ Ú©Ù…ÛŒ / Ú©ÛŒÙÛŒ</th>
                                    <th class="text-center"> ÙØ±ÙˆØ´ Ø§Ø¶Ø·Ø±Ø§Ø±ÛŒ</th>
                                    <th class="text-center"> Ø§Ø®ØªÙ„Ø§Ù Ù†Ø§ Ù…Ø¬Ø§Ø²</th>
                                </tr>
                                <tbody>
                                {% for item in list %}
                                    <tr>
                                        <td>{{ item.product__name }}</td>
                                        <td style="font-size: 18px;">{{ item.res }}</td>
                                        <td style="font-size: 18px;">{{ item.sum_sellkol }}</td>
                                        <td style="font-size: 18px;">{{ item.sum_yarane }}</td>
                                        <td style="font-size: 18px;">{{ item.sum_azad }}</td>
                                        <td style="font-size: 18px;">{{ item.sum_ezterari }}</td>
                                        <td style="font-size: 18px;">{{ item.sum_azmayesh }}</td>
                                        <td style="font-size: 18px;">{{ item.sum_haveleh }}</td>
                                        <td style="font-size: 18px;">{{ item.sum_nomojaz3 }}</td>

                                    </tr>
                                {% endfor %}
                                </tbody>


                            </table>
                        </div>
                        {% if tlist %}
                            <div class="row text-left  m-b" style="border-bottom: 1px solid rgb(69, 69, 69)">
                            <div class="table-responsive">
                                <table class="table table-bordered table-hover text-center text-base ">
                                    <caption style="display: none">Ú¯Ø²Ø§Ø±Ø´ 1502</caption>
                                    <thead>
                                    <tr class="vendorListHeading">
                                        <th class="text-center">Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¨Ù†Ø²ÛŒÙ† Ù…Ø¹Ù…ÙˆÙ„ÛŒ</th>
                                        <th class="text-center">Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¨Ù†Ø²ÛŒÙ† Ø³ÙˆÙ¾Ø±</th>
                                        <th class="text-center">Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ù†ÙØªÚ¯Ø§Ø²</th>

                                    </tr>
                                    <tbody>
                                    {% for item in tlist %}
                                        <tr>

                                            <td style="font-size: 18px;">{{ item.benzin }}</td>
                                            <td style="font-size: 18px;">{{ item.super }}</td>
                                            <td style="font-size: 18px;">{{ item.gaz }}</td>


                                        </tr>
                                    {% endfor %}
                                    </tbody>


                                </table>
                            </div>
                        {% endif %}
                        <table>
                            <thead></thead>
                            <tbody>
                            {% for item in edits %}
                                <tr>
                                    <td> {{ forloop.counter }} : Ù†Ø§Ø²Ù„ {{ item.sell.tolombeinfo.number }} Ø¯Ø±
                                        ØªØ§Ø±ÛŒØ® {{ item.tarikh }} ØªÙˆØ³Ø· {{ item.owner.name }} {{ item.owner.lname }}
                                        Ø¨Ø±Ø§ÛŒ Ù†Ø±Ø® {{ item.status }} Ø§Ø² {{ item.old }} Ø¨Ù‡ {{ item.new }} ÙˆÛŒØ±Ø§ÛŒØ´ Ø´Ø¯.
                                    </td>
                                </tr>
                            {% endfor %}
                             {% for item in sell %}
                                 <tr>
                                 {% if item.is_change_counter %}<td>
                                 Ù†Ø§Ø²Ù„ {{ item.pumpnumber }} ØªØ¹ÙˆÛŒØ¶ ØªÙˆØªØ§Ù„Ø§ÛŒØ²Ø± Ø¯Ø§Ø´Øª
                                     </td>{% endif %}
                                                                <tr>
                                 {% if item.mogh == 1 %} <td>
                                 Ù†Ø§Ø²Ù„ {{ item.pumpnumber }}  Ø´Ù…Ø§Ø±Ù‡ Ø§ÙˆÙ„ ÙˆÙ‚Øª ÙˆÛŒØ±Ø§ÛŒØ´ Ø´Ø¯
                                     </td>{% endif %}

                                 </tr>
                            {% endfor %}

                            </tbody>
                        </table>
                        </div>

                    </div>
                </div>
            </div>
            <div class="col-1"></div>
        </div>

</body>
</div>
<div class="modal fade" id="EventInfo" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalCenterTitle">ØªÙˆØ¶ÛŒØ­Ø§Øª ÙØ±ÙˆØ´</h5>
                <button type="button" class="btn nav-link bg-info-bright" aria-label="Close" data-dismiss="modal">
                    <i class="ti-close" aria-hidden="true"></i>
                </button>
            </div>
            <div class="modal-body">
                <h3 class="text-success">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³ÛŒØ³ØªÙ…ÛŒ</h3>
                <div class="form-group">
                    <div class="table-responsive">
                        <table id="SyatemTable" class="table table-striped table-bordered">
                            <caption style="display: none">Ù¾ÛŒØ§Ù… Ù‡Ø§</caption>
                            <thead>
                            <tr>
                                <th scope="col" class="text-center">Ø´Ø±Ø­</th>
                                <th scope="col" class="text-center"> Ù…Ù‚Ø¯Ø§Ø±</th>
                            </tr>
                            </thead>
                            <tbody>

                            </tbody>

                        </table>

                    </div>
                </div>


                <h3 class="text-info">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø±Ø¬ Ø´Ø¯Ù‡</h3>
                <div class="form-group">
                    <div class="table-responsive">
                        <table id="UserTable" class="table table-striped table-bordered">
                            <caption style="display: none">Ù¾ÛŒØ§Ù… Ù‡Ø§</caption>
                            <thead>
                            <tr>
                                <th scope="col" class="text-center">Ø´Ø±Ø­</th>
                                <th scope="col" class="text-center"> ØªØ§Ø±ÛŒØ®</th>
                                <th scope="col" class="text-center"> Ú©Ø§Ø±Ø¨Ø±</th>
                            </tr>
                            </thead>
                            <tbody>

                            </tbody>

                        </table>
                        <a onclick="dellsystemlog()" title="Ø­Ø°Ù"><i data-feather="trash"
                                                                    class="mr-2 width-15 height-15 text-danger"
                                                                    aria-hidden="true"></i></a>
                    </div>
                </div>


            </div>
            <hr class="text-danger">
            <div class="container">
                <div class="form-group">
                    <label for="inform_id">Ø¹Ù„Øª Ø§Ø®ØªÙ„Ø§Ù</label>
                    <select name="inform" id="inform_id" class="form-control">
                         <option value="1">Ø¬Ø¨Ø±Ø§Ù† ÙØ±ÙˆØ´ Ø¨Ù‡ Ø±ÙˆØ² Ø¨Ø¹Ø¯</option>
                        <option value="2">Ø¬Ø¨Ø±Ø§Ù† ÙØ±ÙˆØ´ Ø¯Ø± Ø±ÙˆØ² Ù‚Ø¨Ù„</option>
                        <option value="3">Ø§Ø´ØªØ¨Ø§Ù‡ Ø¯Ø± Ø«Ø¨Øª Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡ Ù‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒÚ©ÛŒ</option>
                        <option value="4">Ø§Ø´Ú©Ø§Ù„Ø§Øª Ù…Ú©Ø§Ù†ÛŒÚ©ÛŒ </option>
                        <option value="5">Ù¾Ø±Ø´ Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡ Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ</option>
                        <option value="6">Ø®Ø±Ø§Ø¨ÛŒ Ú©Ø§Ø±ØªØ®ÙˆØ§Ù†ØŒ Ø±ÙØªÙ† Ø¨Ø±Ù‚ Ùˆ...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Ù…Ù‚Ø¯Ø§Ø± ØµØ­ÛŒØ­ Ø§Ø®ØªÙ„Ø§Ù</label>
                    <input id="amount_id" type="text" class="form-control">
                </div>
                <button onclick="addsystemlog(document.getElementById('sellid').value,document.getElementById('inform_id').value,document.getElementById('amount_id').value)"
                        class="btn btn-success" data-dismiss="modal">Ø°Ø®ÛŒØ±Ù‡
                </button>
            </div>
            <div class="modal-footer">
                <ul class="nav">
                    <li class="nav-item">

                    </li>
                </ul>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Ø¨Ø³ØªÙ†
                </button>

            </div>
        </div>
    </div>
</div>
{% include 'script_sell.html' %}
{% include 'script.html' %}
</html>
<script>
    function set_to_print() {
        // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ú©Ù„Ø§Ø³ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´
        $('body').addClass('print-mode');

        // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ ØºÛŒØ±Ø¶Ø±ÙˆØ±ÛŒ
        $('.no-print').hide();

        // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù‚Ø¨Ù„ Ø§Ø² Ù¾Ø±ÛŒÙ†Øª
        var printStyles = `
            <style>
                @media print {
                    @page {
                        size: A4 landscape;
                        margin: 10mm;
                    }
                    body {
                        width: 297mm !important;
                        height: 210mm !important;
                        margin: 0 !important;
                        padding: 5mm !important;
                        transform: scale(0.95);
                    }
                    .table {
                        font-size: 7pt !important;
                    }
                    .table td, .table th {
                        padding: 1px 2px !important;
                    }
                }
            </style>
        `;
        $('head').append(printStyles);

        // ØªØ§Ø®ÛŒØ± Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ø§Ø¹Ù…Ø§Ù„ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§
        setTimeout(function() {
            window.print();

            // Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ Ø¨Ø¹Ø¯ Ø§Ø² Ù¾Ø±ÛŒÙ†Øª
            setTimeout(function() {
                $('.no-print').show();
                $('body').removeClass('print-mode');
                $('style').last().remove();
            }, 500);
        }, 300);
    }

    // Ø¯Ú©Ù…Ù‡ Ù¾Ø±ÛŒÙ†Øª Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯
    $(document).ready(function() {
        $('body').append(`
            <div class="no-print" style="position: fixed; top: 10px; left: 10px; z-index: 10000;">
                <button class="btn btn-success" onclick="set_to_print()" style="padding: 10px 20px; font-size: 16px;">
                    ğŸ–¨ï¸ Ù¾Ø±ÛŒÙ†Øª Ú¯Ø²Ø§Ø±Ø´ (Landscape)
                </button>
            </div>
        `);
    });
</script>
<script>

    var observe;
    if (window.attachEvent) {
        observe = function (element, event, handler) {
            element.attachEvent('on' + event, handler);
        };
    } else {
        observe = function (element, event, handler) {
            element.addEventListener(event, handler, false);
        };
    }

    function init() {
        var text = document.getElementById('factor_description1');

        function resize() {
            text.style.height = 'auto';
            text.style.height = text.scrollHeight + 'px';
        }

        /* 0-timeout to get the already changed text */
        function delayedResize() {
            window.setTimeout(resize, 0);
        }

        observe(text, 'change', resize);
        observe(text, 'cut', delayedResize);
        observe(text, 'paste', delayedResize);
        observe(text, 'drop', delayedResize);
        observe(text, 'keydown', delayedResize);

        text.focus();
        text.select();
        resize();
    }

</script>
</main>

</div>
</div>
</div>


<script>

    $(window).load(function () {
        set_to_print();
    });
</script>
