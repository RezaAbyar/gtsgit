<!DOCTYPE html>
{% load humanize %}
{% load static %}
<html lang="fa" dir="rtl">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keyword" content="">

    <title>Ú†Ø§Ù¾ ÙØ±ÙˆØ´</title>
  {% include 'headers2.html' %}


    <style>
        body, table {
            font-size: 12px !important;
            position: relative !important;
            margin-top: 0 !important;
        }

        .rotate {
            position: relative;
            bottom: -25px !important;
        }

        td {
            padding: 5px 10px 5px 10px !important;
        }

        h4 {
            font-size: 14px !important;
        }

        #accordion {
            margin: 2px 5px 2px 5px !important;
        }

        .img-rounded {
            width: 120px !important;
        }

        @media print {
            div#printfooter {
                page-break-before: avoid !important;
            }
        }

        #printfooter {
            margin: 5px !important;
        }

        .factor-res {
            font-size: 12px !important;
        }

        .a5-margin-5 {
            margin: 5px !important;
        }

        .a5-small-font-size > * {
            font-size: x-small !important;
        }

        .a5-medium-font-size > * {
            font-size: small !important;
        }

        .a5-xsmall-font-size > * {
            font-size: xx-small !important;
        }

        .a5-children-py2 > * {
            padding-bottom: 2px !important;
            padding-top: 2px !important;
        }

        .a5-children-px3 > * {
            padding-right: 3px !important;
            padding-left: 3px !important;
        }
            @media print {
        .no-print {
            display: none !important;
        }
    }
    </style>

<script>
        $(window).load(function () {
            $(".se-pre-con").fadeOut("slow");
        });
    </script>
</head>

<body>
<script src="{% static 'assets/js/tableToExcel.js' %}"></script>
      <link type="text/css" rel="stylesheet" href="{% static 'assets/css/jalalidatepicker.min.css' %} " />
<script type="text/javascript" src="{% static 'assets/js/jalalidatepicker.min.js' %}"></script>
        {% include 'message.html' %}
    <div class="col-lg-12 col-md-12 col-sm-12">

        <div class="card">
            <div class="card-body no-print">

        <ul class="nav">
            <div class="row">
                <div class="container">
                    <div class="col-12">
                        <h3 class="c-center c-font-uppercase c-font-bold"> Ú¯Ø²Ø§Ø±Ø´   Ø¯ÙˆØ±Ù‡ Ø§ÛŒÛŒ
                            </h3>
                        <form action="" method="post">
                            {% csrf_token %}

                            <hr>

                            <label> Ù†Ø§Ù… Ø¬Ø§ÛŒÚ¯Ø§Ù‡
                                <select name="select3" onclick="$(this).select()"

                                        class="select2-example">
                                    {% if request.user.owner.role.role == "gs" %}
                                    {% for gs in gss %}
                               <option {% if gs.gs.id == gsid %} selected {% endif %} value="{{ gs.gs.id }}"
                                        >{{ gs.gs.gsid }}-{{ gs.gs.name }}</option>
                                    {% endfor %}
                                        {% else %}
                                             {% for gs in gss %}
                                        <option {% if gs.id == gsid %} selected {% endif %} value="{{ gs.id }}"
                                        >{{ gs.gsid }}-{{ gs.name }}</option>
                                    {% endfor %}

                                {% endif %}
                                </select>
                            </label>



                            <label>Ø§Ø² ØªØ§Ø±ÛŒØ®

                                <input required data-jdp type="text" name="select" id="select" value="{{ az }}" class="form-control" placeholder="ØªØ§Ø±ÛŒØ®" autocomplete="off">
                            </label>

                            <label>ØªØ§ ØªØ§Ø±ÛŒØ®
                                <input required data-jdp type="text" name="select2" id="select2" value="{{ ta }}" class="form-control" placeholder="ØªØ§Ø±ÛŒØ®" autocomplete="off">
                            </label>
                            <button type="submit" class="btn btn-warning c-btn-uppercase">Ù…Ø´Ø§Ù‡Ø¯Ù‡</button>



                        </form>
                    </div>
                </div>
            </div>
        </ul>


    </div></div>

<div class="panel-body">
    <div id="accordion" style="margin: 20px;">




            <br>
            <br>
            <br>
            <br>
            <br>

            <div class="row ">
                <div class="col-1"></div>
                <div class="col-10 ">
<span> ØªØ§Ø±ÛŒØ® ØªÙ‡ÛŒÙ‡ Ú¯Ø²Ø§Ø±Ø´ {{ today }}</span>

                    <div class="table-responsive">
                        <table class="table table-bordered table-hover text-center text-base "
                               style="direction: rtl; margin-top:6px">
                         <caption style="display: none">Ù¾Ø±ÛŒÙ†Øª 1502 Ø¯ÙˆØ±Ù‡ Ø§ÛŒÛŒ</caption>
                               <thead>
                         <th scope="col" colspan="2" class="text-center"><img alt="logo" src="{% static 'assets/media/image/logo.png' %}"> </th>
                        {% if hdcrash %}
                         <th style="font-size: 20px;" colspan="9" class="text-center">ÙØ±Ù… ØªØ¹ÙˆÛŒØ¶ Ù‡Ø§Ø±Ø¯</th>
{% else %}
                         <th style="font-size: 20px;" colspan="9" class="text-center"> 1502 Ø¯ÙˆØ±Ù‡ Ø§ÛŒÛŒ</th>
                         {% endif %}
                        <th style="font-size: 14px;" colspan="2" class="text-center">{{ general.name }}</th>
                        <th style="font-size: 15px;" colspan="1" class="text-center"> {{ date }}</th>
                        </thead>
                        <thead>
                         <th scope="col" colspan="1" class="text-center">Ù…Ù†Ø·Ù‚Ù‡ :{{ general.area.zone.name }}</th>
                         <th scope="col"  class="text-center">Ù†Ø§Ø­ÛŒÙ‡ :{{ general.area.name }}</th>
                        <th style="font-size: 15px;" colspan="9" class="text-center"> Ú¯Ø²Ø§Ø±Ø´ ØªÙØ§ÙˆØª Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡ Ù‡Ø§ÛŒ Ù…Ú©Ø§Ù†ÛŒÚ©ÛŒ Ùˆ Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ Ø§Ø² ØªØ§Ø±ÛŒØ® {{ az }} Ø§Ù„ÛŒ {{ ta }}</th>
                        <th style="font-size: 20px;" colspan="3" class="text-center">Ú©Ø¯ Ø¬Ø§ÛŒÚ¯Ø§Ù‡ :{{ general.gsid }}</th>
                        </thead>
                                   <thead>
                                   <tr>

                                <th scope="col" rowspan="2" class="text-center">Ø´Ù…Ø§Ø±Ù‡ Ù†Ø§Ø²Ù„</th>
                                <th scope="col" rowspan="2" class="text-center">ÙØ±Ø¢ÙˆØ±Ø¯Ù‡</th>
                         <th scope="col" colspan="2" class="text-center">Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡ Ù…Ú©Ø§Ù†ÛŒÚ©ÛŒ</th>
                         <th scope="col" colspan="7"   class="text-center">ÙØ±ÙˆØ´</th>
                         <th scope="col" colspan="3"  class="text-center">Ø§Ø®ØªÙ„Ø§Ù</th>
                       </tr>
                            <tr class="vendorListHeading">

                                 <th scope="col"  class="text-center">Ø´Ù…Ø§Ø±Ù‡ Ø§ÙˆÙ„ ÙˆÙ‚Øª</th>
                                <th scope="col"  class="text-center">Ø´Ù…Ø§Ø±Ù‡ Ø¢Ø®Ø± ÙˆÙ‚Øª</th>
                                <th scope="col"  class="text-center"> Ù…Ú©Ø§Ù†ÛŒÚ©ÛŒ</th>
                                <th scope="col"  class="text-center">Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ</th>
                                <span id="detok">
                                <th style="background-color: #eaeaea" scope="col" class="text-center"> ÛŒØ§Ø±Ø§Ù†Ù‡ Ø§ÛŒÛŒ</th>
                                     <th class="text-center"> ÙØ±ÙˆØ´  Ù†ÛŒÙ…Ù‡ ÛŒØ§Ø±Ø§Ù†Ù‡ Ø§ÛŒÛŒ</th>
                                <th style="background-color: #eaeaea" scope="col"  class="text-center"> Ø¢Ø²Ø§Ø¯</th>
                                <th style="background-color: #eaeaea" scope="col"  class="text-center"> Ú©Ø§Ø±Øª Ø¬Ø§ÛŒÚ¯Ø§Ù‡</th>
                                <th style="background-color: #eaeaea" scope="col"  class="text-center"> Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒ/Ú©Ù…ÛŒ</th>
                                <th style="background-color: #eaeaea" scope="col" scope="col"  class="text-center"> Ú©Ø§Ø±Øª Ø§Ø¶Ø·Ø±Ø§Ø±ÛŒ</th>
                                    </span>
                                <th scope="col"  class="text-center"> Ù…Ú©Ø§Ù†ÛŒÚ©ÛŒ Ùˆ Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ</th>
                                <th scope="col"  class="text-center"> Ù…Ø¬Ø§Ø²</th>
                                <th scope="col"  class="text-center"> ØºÛŒØ±Ù…Ø¬Ø§Ø²</th>

                            </tr>
                            </thead>
                            <tbody>
                            {% for item in sell %}
                                <tr>

                                    <td style="font-size: 18px;">{{ item.tolombeinfo__number }}</td>
                                    <td>{{ item.product__name }}</td>
                                    <td style="font-size: 18px;">{{ item.avalvaght|intcomma:False }}</td>
                                    <td style="font-size: 18px;">{{ item.akharvaght|intcomma:False }}</td>
                                    <td style="font-size: 18px;">{{ item.res|intcomma:False }}</td>
                                    <td style="font-size: 18px;">{{ item.sum_sellkol|intcomma:False }}</td>
                                {% if item.product__name == 'Ù†ÙØª Ú¯Ø§Ø²' %}
                                          <td style="font-size: 18px;">0</td>
                                        {% else %}
                                          <td style="font-size: 18px;">{{ item.sum_yarane|intcomma:False }}</td>
                                        {% endif %}

                                    <td style="font-size: 18px;">{{ item.sum_nimeyarane|intcomma:False }}</td>
                                     <td style="font-size: 18px;">{{ item.sum_azad1|intcomma:False }}</td>

                                    <td style="background-color: #eaeaea;font-size: 18px;">{{ item.sum_ezterari|intcomma:False }}</td>
                                    <td style="background-color: #eaeaea;font-size: 18px;">{{ item.sum_azmayesh|intcomma:False }}</td>
                                    <td style="background-color: #eaeaea;font-size: 18px;">{{ item.sum_haveleh|intcomma:False }}</td>
                                    {% if item.res > item.sum_sellkol %}
                                    <td style="font-size: 18px;">({{ item.sum_ekhtelaf }})</td>
                                    {% else %}
                                    <td style="font-size: 18px;">{{ item.sum_ekhtelaf }}</td>
                                    {% endif %}
                                    <td style="font-size: 18px;">{{ item.sum_mojaz }}</td>
                                    <td style="font-size: 18px;">{{ item.sum_nomojaz3 }}</td>




                                </tr>


                            {% endfor %}
                            </tbody>
                        </table>
                    </div>


    <br>
    <br>
        <div class="row m-b">
            <div class="col-sm-2">
                <div class="pull-right form-group">
                    <label for="factor_description"><strong>Ù…Ù‡Ø± Ùˆ Ø§Ù…Ø¶Ø§ Ø¬Ø§ÛŒÚ¯Ø§Ù‡: </strong></label>
                    <textarea class="form-control" id="factor_description1" name="factor_description1" rows="4"
                              cols="500" readonly></textarea>
                </div>
            </div>
            <div class="col-sm-10">

                <div class="row text-left  m-b" style="border-bottom: 1px solid rgb(69, 69, 69)">


                         <div class="table-responsive">
                        <table class="table table-bordered table-hover text-center text-base ">
                         <caption style="display: none">Ú¯Ø²Ø§Ø±Ø´ 1502</caption>
                               <thead>

                        <tr class="vendorListHeading">
                                <th class="text-center">ÙØ±Ø¢ÙˆØ±Ø¯Ù‡</th>
                                <th class="text-center">Ù…Ø¬Ù…ÙˆØ¹ ÙØ±ÙˆØ´ Ù…Ú©Ø§Ù†ÛŒÚ©ÛŒ</th>
                                <th class="text-center"> ÙØ±ÙˆØ´ Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ</th>
                                <th class="text-center"> ÙØ±ÙˆØ´ ÛŒØ§Ø±Ø§Ù†Ù‡ Ø§ÛŒÛŒ</th>
                                <th class="text-center"> ÙØ±ÙˆØ´ Ø¢Ø²Ø§Ø¯</th>
                                <th class="text-center"> ÙØ±ÙˆØ´ Ú©Ø§Ø±Øª Ø¬Ø§ÛŒÚ¯Ø§Ù‡</th>
                                <th class="text-center"> ÙØ±ÙˆØ´ Ú©Ù†ØªØ±Ù„ Ú©Ù…ÛŒ / Ú©ÛŒÙÛŒ</th>
                                <th class="text-center"> ÙØ±ÙˆØ´ Ø§Ø¶Ø·Ø±Ø§Ø±ÛŒ</th>
                                <th class="text-center"> Ø§Ø®ØªÙ„Ø§Ù Ù†Ø§ Ù…Ø¬Ø§Ø²</th>
                        </tr>
                        <tbody>
                        {% for item in list2 %}
                         <tr>
                                    <td>{{ item.product__name }}</td>
                                    <td  style="font-size: 18px;">{{ item.res }}</td>
                                    <td style="font-size: 18px;">{{ item.sum_sellkol }}</td>

                                    <td style="font-size: 18px;">{{ item.sum_yarane }}</td>
                                    <td style="font-size: 18px;">{{ item.sum_azad }}</td>
                                    <td style="font-size: 18px;">{{ item.sum_ezterari }}</td>
                                    <td style="font-size: 18px;">{{ item.sum_azmayesh }}</td>
                                    <td style="font-size: 18px;">{{ item.sum_haveleh }}</td>
                                    <td style="font-size: 18px;">{{ item.sum_nomojaz3 }}</td>

                         </tr>
                        {% endfor %}
                        </tbody>


                        </table>
                </div>

                </div>

            </div>
        </div>
                </div>
<div class="col-1"></div>
    </div>
    </div>
</body>
</html>

<script>

    var observe;
    if (window.attachEvent) {
        observe = function (element, event, handler) {
            element.attachEvent('on' + event, handler);
        };
    } else {
        observe = function (element, event, handler) {
            element.addEventListener(event, handler, false);
        };
    }

    function init() {
        var text = document.getElementById('factor_description1');

        function resize() {
            text.style.height = 'auto';
            text.style.height = text.scrollHeight + 'px';
        }

        /* 0-timeout to get the already changed text */
        function delayedResize() {
            window.setTimeout(resize, 0);
        }

        observe(text, 'change', resize);
        observe(text, 'cut', delayedResize);
        observe(text, 'paste', delayedResize);
        observe(text, 'drop', delayedResize);
        observe(text, 'keydown', delayedResize);

        text.focus();
        text.select();
        resize();
    }

</script>


</main>

</div>
</div>
</div>
{% include 'script.html' %}
<script>
    function set_to_print() {
        // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ú©Ù„Ø§Ø³ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´
        $('body').addClass('print-mode');

        // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ ØºÛŒØ±Ø¶Ø±ÙˆØ±ÛŒ
        $('.no-print').hide();

        // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù‚Ø¨Ù„ Ø§Ø² Ù¾Ø±ÛŒÙ†Øª
        var printStyles = `
            <style>
                @media print {
                    @page {
                        size: A4 landscape;
                        margin: 10mm;
                    }
                    body {
                        width: 297mm !important;
                        height: 210mm !important;
                        margin: 0 !important;
                        padding: 5mm !important;
                        transform: scale(0.95);
                    }
                    .table {
                        font-size: 7pt !important;
                    }
                    .table td, .table th {
                        padding: 1px 2px !important;
                    }
                }
            </style>
        `;
        $('head').append(printStyles);

        // ØªØ§Ø®ÛŒØ± Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ø§Ø¹Ù…Ø§Ù„ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§
        setTimeout(function() {
            window.print();

            // Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ Ø¨Ø¹Ø¯ Ø§Ø² Ù¾Ø±ÛŒÙ†Øª
            setTimeout(function() {
                $('.no-print').show();
                $('body').removeClass('print-mode');
                $('style').last().remove();
            }, 500);
        }, 300);
    }

    // Ø¯Ú©Ù…Ù‡ Ù¾Ø±ÛŒÙ†Øª Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯
    $(document).ready(function() {
        $('body').append(`
            <div class="no-print" style="position: fixed; top: 10px; left: 10px; z-index: 10000;">
                <button class="btn btn-success" onclick="set_to_print()" style="padding: 10px 20px; font-size: 16px;">
                    ğŸ–¨ï¸ Ù¾Ø±ÛŒÙ†Øª Ú¯Ø²Ø§Ø±Ø´ (Landscape)
                </button>
            </div>
        `);
    });
</script>
<script>

    $(window).load(function () {
        set_to_print();
    });
</script>
<script>
        jalaliDatepicker.startWatch();
        $('.select2-example').select2({
            placeholder: 'Select'
        });
    </script>
<script>

                    $("#exportBtn11").click(function () {

                TableToExcel.convert(document.getElementById("tab1"), {
                    name: "sell.xlsx",
                    sheet: {
                        name: "Sheet1"
                    }
                });
            });
    </script>