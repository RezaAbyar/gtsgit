{% extends 'base.html' %}
{% load humanize %}
{% load static %}
{% block css %}


{% endblock %}
{% block context %}
        <link type="text/css" rel="stylesheet" href="{% static 'assets/css/jalalidatepicker.min.css' %} " />
<script type="text/javascript" src="{% static 'assets/js/jalalidatepicker.min.js' %}"></script>
        <script src="{% static 'assets/js/tableToExcel.js' %}"></script>

    {% include 'message.html' %}
    <div class="col-lg-12 col-md-12 col-sm-12">

        <div class="card">
            <div class="card-body">

        <ul class="nav">
            <div class="row">
                <div class="container">
                    <div class="col-12">
                        <h3 class="c-center c-font-uppercase c-font-bold"> گزارش لیست جایگاه های فروش ثبت نشده
                         </h3>
                        <form action="" method="post">
                            {% csrf_token %}
                            <hr>

                           <label> انتخاب تاریخ دوره
                                <input required data-jdp type="text" name="select" id="select" value="{{ az }}" class="form-control" placeholder="تاریخ" autocomplete="off">
                            </label>
                            <button type="submit" class="btn btn-warning c-btn-uppercase">گزارش</button>

                             <button onclick="exportToExcelWithBorders()" id="exportBtn1" style="color: #fffbff" class="btn nav-link bg-info" title="ارسال به اکسل ">
                <i data-feather="send" aria-hidden="true"></i>ارسال به اکسل
            </button>
                             <input style="background: rgba(255,239,239,0.97); color: #0b0b0b" onkeyup="myFunction()" type="text" name="search" id="id_search" class="form-control search-input" autocomplete="off"
                                    placeholder="جستجو">
                            <br>
      </form>

                    </div>
                </div>
            </div>
        </ul>

{% if request.user.owner.role.role in 'setad,mgr' %}
             <div class="row">
            <div class="col-lg-12">
                <div class="table-responsive">
                    <table id="tab1" class="table table-striped table-bordered">
                    <caption style="display: none">فروش وجود ندارد</caption>
                        <tr style="background: #ececec; color: #0b0b0b">
                            <th class="align-middle text-center text-sm" scope="col">ردیف</th>
                            <th class="align-middle text-center text-sm" scope="col"> منطقه</th>
                            <th class="align-middle text-center text-sm" scope="col">تعداد</th>

                        </tr>


                        <tbody>
                        {% for lists in gsgroup %}
                            <tr>
                                <th class="align-middle text-center text-sm"
                                    scope="row">{{ forloop.counter }}</th>
                                <td class="align-middle text-center text-sm"><a style="color: #0d5ff5" href="{% url 'sell:report_dosenotexistgroup' lists.area__zone_id tarikh %}"> {{ lists.area__zone__name }}</a></td>
                                 <td  class="align-middle text-center text-sm">{{ lists.tedad }}</td>



                            </tr>
                        {% endfor %}
                        </tbody>
                        <tfoot>


                        </tfoot>
                    </table>


                </div>
{% else %}

        <div class="row">
            <div class="col-lg-12">
                <div class="table-responsive">
                    <table id="tab1" class="table table-striped table-bordered">
                    <caption style="display: none">فروش وجود ندارد</caption>
                        <tr style="background: #ececec; color: #0b0b0b">
                            <th scope="col">#</th>
                            <th class="align-middle text-center text-sm" scope="col"> منطقه</th>
                            <th class="align-middle text-center text-sm" scope="col">ناحیه</th>
                            <th class="align-middle text-center text-sm" scope="col"> GSID</th>
                            <th class="align-middle text-center text-sm" scope="col">  نام جایگاه </th>
                        </tr>


                        <tbody>
                        {% for lists in list %}
                            <tr>
                                <th class="align-middle text-center text-sm"
                                    scope="row">{{ forloop.counter }}</th>
                                <td class="align-middle text-center text-sm">{{ lists.area.zone.name }}</td>
                                 <td  class="align-middle text-center text-sm">{{ lists.area.name }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.gsid }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.name }}</td>


                            </tr>
                        {% endfor %}
                        </tbody>
                        <tfoot>


                        </tfoot>
                    </table>


                </div>
                {% endif %}
            </div>
        </div>
    </div></div>

    <script>
      function toexcel() {

                    TableToExcel.convert(document.getElementById("tab1"), {
                        name: "sell.xlsx",
                        sheet: {
                            name: "Sheet1"
                        }
                    });
                }
        $('#btnid').click(function () {
            var x = document.getElementById("filter_id");
            if (window.getComputedStyle(x).display === "none") {

                document.getElementById('filter_id').style.display = 'block';

            } else {
                document.getElementById('filter_id').style.display = 'none';
            }
        });
        $('#btnid2').click(function () {

            document.getElementById('filter_id').style.display = 'none';
        });
    </script>

{% endblock %}

{% block script %}
<script>
        jalaliDatepicker.startWatch();
        function myFunction() {
  var input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("id_search");
  filter = input.value.toUpperCase();
  table = document.getElementById("tab1");
  tr = table.getElementsByTagName("tr");
  for (i = 0; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[0];
    if (td) {
      txtValue = td.textContent || td.innerText;
      if (txtValue.toUpperCase().indexOf(filter) > -1) {
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }
  }
}
    </script>
{% endblock %}