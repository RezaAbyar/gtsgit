{% extends 'base.html' %}
{% load humanize %}
{% load static %}

{% block css %}

    <style>
        thead,
        tfoot {
            background-color: #3f87a6;
            color: #fff;
        }
    </style>

{% endblock %}
{% block context %}
        <script src="{% static 'assets/js/tableToExcel.js' %}"></script>
        <link type="text/css" rel="stylesheet" href="{% static 'assets/css/jalalidatepicker.min.css' %} " />
<script type="text/javascript" src="{% static 'assets/js/jalalidatepicker.min.js' %}"></script>
        {% include 'message.html' %}
    <div class="col-lg-12 col-md-12 col-sm-12">

        <div class="card">
            <div class="card-body">

        <ul class="nav">
            <div class="row">
                <div class="container">
                    <div class="col-12">
                        <a onclick="exportToExcelWithBorders()" id="exportBtn1" style="color: #fffbff" class="btn nav-link bg-info" title="ارسال به اکسل "> <i data-feather="send" aria-hidden="true"></i>ارسال به اکسل</a>
                        <h3 class="c-center c-font-uppercase c-font-bold"> گزارش لیست فروش {{ fname }} جایگاه های {{ nname }} از تاریخ  {{ newmdate }} تا {{ newmdate2 }}
                         </h3>


                    </div>
                </div>
            </div>
        </ul>

        <div class="row">
            <div class="col-lg-12">
                <div class="table-responsive">
                    <table id="tab1" class="table table-striped table-bordered">
                    <caption style="display: none">گزارش فروش</caption>
                    <thead>
                    <tr style="background: #ececec; color: #0b0b0b">
                        <td></td>
                        <td></td>
                        <td colspan="2" class="text-center">با کارت شخصی</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td colspan="2" class="text-center">نرخ دوم</td>
                        <td colspan="4" class="text-center">به کل فروش</td>

                    </tr>

                    </thead>

                       <tr style="background: #ececec; color: #0b0b0b">
                            <th scope="col">#</th>
                            <th class="align-middle text-center text-sm" scope="col">نام منطقه</th>
                            <th class="align-middle text-center text-sm" scope="col"> نرخ اول</th>
                            <th class="align-middle text-center text-sm" scope="col"> نرخ دوم</th>
                            <th class="align-middle text-center text-sm" scope="col">   کارت اضطراری جایگاه </th>
                             <th class="align-middle text-center text-sm" scope="col">جمع کل فروش </th>
                            <th class="align-middle text-center text-sm" scope="col"> مجموع نرخ دوم</th>
                            <th class="align-middle text-center text-sm" scope="col"> درصد کارت شخصی</th>
                            <th class="align-middle text-center text-sm" scope="col"> درصد کارت جایگاه</th>
                            <th class="align-middle text-center text-sm" scope="col"> درصد نرخ اول</th>
                            <th class="align-middle text-center text-sm" scope="col"> درصد نرخ دوم </th>
                            <th class="align-middle text-center text-sm" scope="col"> درصد کارت اضطراری</th>
                            <th class="align-middle text-center text-sm" scope="col"> درصد کارت شخصی </th>


                        </tr>


                        <tbody>
                        {% for lists in list %}
                            <tr>
                                <th class="align-middle text-center text-sm"
                                    scope="row">{{ forloop.counter }}</th>
                                <td class="align-middle text-center text-sm">{{ lists.name }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.yarane|intcomma:False }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.azad_personal|intcomma:False }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.azad_gs|intcomma:False }}</td>
                                 <td  class="align-middle text-center text-sm">{{ lists.sum_sell|intcomma:False }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.sum_nerkh2|intcomma:False }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.darsad_personal|intcomma:False }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.darsad_gs|intcomma:False }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.d_n_1_to_kol|intcomma:False }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.d_n_2_p_to_kol|intcomma:False }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.d_n_2_g_to_kol|intcomma:False }}</td>
                                <td class="align-middle text-center text-sm">{{ lists.d_p_to_kol|intcomma:False }}</td>

                            </tr>
                        {% endfor %}
                        </tbody>
                        <tfoot>

                        <tr style="background: #dbd9de; color: black">
                            <th scope="col"></th>
                            <th class="align-middle text-center text-sm" scope="col" >جمع کل</th>


                            <td class="align-middle text-center text-sm"
                                >{{ sum_yaraneall|intcomma:False }}</td>
                            <td class="align-middle text-center text-sm"
                                >{{ sum_azadall|intcomma:False }}</td>
                                <td class="align-middle text-center text-sm"
                                >{{ sum_ezterariall|intcomma:False }}</td>
                            <td class="align-middle text-center text-sm"
                                >{{ jam1|intcomma:False }}</td>
                                 <td class="align-middle text-center text-sm"
                                >{{ jam2|intcomma:False }}</td>
                                 <td class="align-middle text-center text-sm"
                                >{{ jam3|intcomma:False }}</td>
                                 <td class="align-middle text-center text-sm"
                                >{{ jam4|intcomma:False }}</td>
                                 <td class="align-middle text-center text-sm"
                                >{{ jam5|intcomma:False }}</td>
                                 <td class="align-middle text-center text-sm"
                                >{{ jam6|intcomma:False }}</td>
                                 <td class="align-middle text-center text-sm"
                                >{{ jam7|intcomma:False }}</td>
                                 <td class="align-middle text-center text-sm"
                                >{{ jam8|intcomma:False }}</td>




                        </tr>
                        </tfoot>
                    </table>


                </div>
            </div>
        </div>
    </div></div>



{% endblock %}
{% block script %}
<script>

                $("#exportBtn11").click(function () {

            TableToExcel.convert(document.getElementById("tab1"), {
                name: "sell.xlsx",
                sheet: {
                    name: "Sheet1"
                }
            })
        })
    </script>
{% endblock %}