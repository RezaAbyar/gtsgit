{% extends 'base.html' %}
{% load static %}

{% block context %}
    <style>
        .blinking {
            animation: blinkingText 1.2s infinite;
        }

        @keyframes blinkingText {
            0% {
                color: #000;
            }
            49% {
                color: transparent;
            }

            99% {
                color: transparent;
            }
            100% {
                color: #000;
            }
        }

        .map:hover {
            background-color: yellow;
        }
    </style>
    <link rel="stylesheet" href="{% static 'vendors/select2/css/select2.min.css' %}" type="text/css">
    <script src="{% static 'assets/js/jquery-3.5.1.min.js' %}"></script>
    {% include 'message.html' %}
    {% include 'ticket/lockmodal.html' %}
    {% include 'ticket/storemodel.html' %}
    {% include 'ticket/erjatotek.html' %}
    {% include 'ticket/filterticket.html' %}

    <div class="card">

        <input type="hidden" id="id_latid" name="id_latid">
        <input type="hidden" id="id_lngid" name="id_lngid">
        <input type="hidden" id="id_ownerrole" value="0">
        <input type="hidden" id="address">
        <input type="hidden" id="GsId">
        <input type="hidden" id="NazelId">


        <h3> تیکت های در حال بررسی <span> تعداد {{ tedad }} </span></h3>

        <ul class="nav">
            <li class="nav-item">
                &nbsp&nbsp
                <a onclick="getFilter()" class="btn nav-link bg-success-bright" title="فیلتر جایگاه ها"
                   data-toggle="tooltip">
                    <i data-feather="filter" aria-hidden="true"></i>فیلترها
                </a>

                &nbsp


                <a href="{% url 'base:TicketToExcel' %}" style="color: #fffbff" class="btn nav-link bg-info"
                   title="ارسال به اکسل "
                >
                    <i data-feather="send" aria-hidden="true"></i>ارسال به اکسل
                </a>

                &nbsp
                <div class="modal" tabindex="-1" role="dialog" id="ItemModal">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">انتخاب آیتم ها</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">×</span>
                                </button>
                            </div>
                            <form action="{% url 'accounts:profileItems' %}" method="post">
                                {% csrf_token %}
                                <div class="modal-body">

                                    <div class="form-group">
                                        <div class="custom-control custom-switch custom-checkbox-warning">
                                            <input type="checkbox" class="custom-control-input" id="shomare"
                                                   name="shomare" {% if request.user.owner.shomare %}
                                                   checked {% endif %}>
                                            <label class="custom-control-label" for="shomare">شماره تیکت</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="custom-control custom-switch custom-checkbox-warning">
                                            <input type="checkbox" class="custom-control-input" id="sarfasl"
                                                   name="sarfasl" {% if request.user.owner.sarfasl %}
                                                   checked {% endif %}>
                                            <label class="custom-control-label" for="sarfasl">سرفصل</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="custom-control custom-switch custom-checkbox-warning">
                                            <input type="checkbox" class="custom-control-input" id="onvan" name="onvan"
                                                    {% if request.user.owner.onvan %} checked {% endif %}>
                                            <label class="custom-control-label" for="onvan">عنوان</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="custom-control custom-switch custom-checkbox-warning">
                                            <input type="checkbox" class="custom-control-input" id="zoner" name="zoner"
                                                    {% if request.user.owner.zoner %} checked {% endif %}>
                                            <label class="custom-control-label" for="zoner">نام منطقه</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="custom-control custom-switch custom-checkbox-warning">
                                            <input type="checkbox" class="custom-control-input" id="arear" name="arear"
                                                    {% if request.user.owner.arear %} checked {% endif %}>
                                            <label class="custom-control-label" for="arear">نام ناحیه</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="custom-control custom-switch custom-checkbox-warning">
                                            <input type="checkbox" class="custom-control-input" id="gsid" name="gsid"
                                                    {% if request.user.owner.gsid %} checked {% endif %}>
                                            <label class="custom-control-label" for="gsid">GSID</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="custom-control custom-switch custom-checkbox-warning">
                                            <input type="checkbox" class="custom-control-input" id="gsname"
                                                   name="gsname" {% if request.user.owner.gsname %} checked {% endif %}>
                                            <label class="custom-control-label" for="gsname">نام جایگاه</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="custom-control custom-switch custom-checkbox-warning">
                                            <input type="checkbox" class="custom-control-input" id="shnazel"
                                                   name="shnazel" {% if request.user.owner.nazel %} checked {% endif %}>
                                            <label class="custom-control-label" for="shnazel">شماره نازل</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="custom-control custom-switch custom-checkbox-warning">
                                            <input type="checkbox" class="custom-control-input" id="product"
                                                   name="product" {% if request.user.owner.product %}
                                                   checked {% endif %}>
                                            <label class="custom-control-label" for="product">نام فرآورده</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="custom-control custom-switch custom-checkbox-warning">
                                            <input type="checkbox" class="custom-control-input" id="createtime"
                                                   name="createtime" {% if request.user.owner.createtime %}
                                                   checked {% endif %}>
                                            <label class="custom-control-label" for="createtime">تاریخ و ساعت
                                                ایجاد</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="custom-control custom-switch custom-checkbox-warning">
                                            <input type="checkbox" class="custom-control-input" id="creator"
                                                   name="creator" {% if request.user.owner.creator %}
                                                   checked {% endif %}>
                                            <label class="custom-control-label" for="creator">نام ایجاد کننده</label>
                                        </div>
                                    </div>

                                </div>
                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-primary">ذخیره تغییرات</button>

                            </form>
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">بستن</button>

                        </div>
                    </div>

                </div>

    </div>

    <button style="color: #fffbff" class="btn nav-link bg-primary" title="تنظیمات صفحه "
            data-toggle="modal"
            data-target="#ItemModal">
        <i data-feather="tool" aria-hidden="true"></i>آیتم ها

    </button>
    </li>
    &nbsp
    <input type="hidden" id="demo">
    <form action="">
        <div class="input-group container">
            <input type="text" id="id_search" name="search" class="form-control" placeholder="جستجوی  تیکت"
                   aria-describedby="button-addon1">
            <div class="input-group-append">
                <button class="btn btn-outline-light" type="submit" id="button-addon1">
                    <i data-feather="search" aria-hidden="true"></i>
                </button>
            </div>
        </div>
    </form>

    </ul>

    {% csrf_token %}

    <div class="card-body">
    {% include 'ticket/days.html' %}

    <div id="responsive" class="table-responsive">
        <table id="myTable" class="table table-striped ">
            <caption style="display: none">تیکت های در حال بررسی</caption>
            <thead>
            {% if request.user.owner.viewtickets == 1 %}
                <tr>
                    <th scope="col">پیگیری</th>
                    <th scope="col">شرح خرابی</th>
                    {% if request.user.owner.zoner or request.user.owner.arear %}
                        <th scope="col">منطقه</th>{% endif %}
                    {% if request.user.owner.gsid or request.user.owner.gsname %}
                        <th scope="col"> جایگاه</th>{% endif %}
                    {% if request.user.owner.nazel or request.user.owner.product %}
                        <th scope="col">نازل</th>{% endif %}
                    {% if request.user.owner.createtime %}
                        <th scope="col">تاریخ ایجاد</th>{% endif %}
                    {% if request.user.owner.creator %}
                        <th scope="col">ثبت کننده</th>{% endif %}

                </tr>
                </thead>
                <tbody>
                {% for g in list %}
                    <tr id="tr{{ g.id }}">
                        <td>

                            <ul class="nav">
                                <li class="nav-item">
                                    <button style="color: #f6fdf7"
                                            onclick="getticket({{ g.id }},1,{{ request.user.owner.role.id }},'{{ g.rnd }}')"
                                            class="btn nav-link bg-secondary-bright"
                                            title={% if g.gs.status_id == 1 %}"بررسی تیکت" {% else %}
                                                {{ g.gs.status.name }} {% endif %} data-toggle="modal"
                                            data-target="#workflowModal">
                                        {% if g.gs.status_id != 1 %}
                                            <i data-feather="eye-off" aria-hidden="true"></i>
                                        {% else %}
                                            {% if request.user.owner.role.role in 'test,fani' %}


                                                {% if g.islock %}
                                                    <i data-feather="lock" aria-hidden="true"></i>
                                                {% else %}
                                                    <i data-feather="eye" aria-hidden="true"></i>

                                                {% endif %}

                                            {% else %}
                                                <i data-feather="eye" aria-hidden="true"></i>
                                            {% endif %}
                                        {% endif %}

                                    </button>

                                     {% if request.user.owner.role.role == 'zone' and request.user.owner.refrence.id == 1 %}
                                        <button style="background: #d0a8f1" onclick="runstore({{ g.id }},'{{ g.rnd }}')"
                                                class="btn btn-apple" title="تخصیص قطعه به تیکت" data-toggle="modal"
                                                data-target="#store">
                                            <i data-feather="paperclip" aria-hidden="true"></i>
                                        </button>

                                    {% endif %}

                                    {% if g.failure.isnazel or g.failure.enname == 'rack' %}
                                        <button style="background: #a8f1b2" onclick="runlock({{ g.id }},'{{ g.rnd }}')"
                                                class="btn btn-apple" title="ثبت پلمپ" data-toggle="modal"
                                                data-target="#plomp">
                                            <i data-feather="key" aria-hidden="true"></i>
                                        </button>

                                    {% endif %}
                                    {% if request.user.owner.role.role == 'tek' %}
                                        <button style="background: #e3c2f3" onclick="runerjatotek({{ g.id }})"
                                                class="btn btn-apple" title="انتقال تیکت به تکنسین دیگر"
                                                data-toggle="modal"
                                                data-target="#erjatotek">
                                            <i data-feather="send" aria-hidden="true"></i>
                                        </button>

                                    {% endif %}
                                </li>
                            </ul>
                        </td>
                        <td><small id="tofailur{{ g.id }}">{{ g.failure.failurecategory.info }}
                            | {{ g.failure.info }}</small>{% if g.reply %}
                            <div class="badge badge-info">{{ g.reply.info }}</div>{% endif %}
                            <hr style="border: #0c5460 1px dashed">
                            <span class="badge badge-light">{{ g.id }}</span>
                            <span id="tofw{{ g.id }}">

                            {% if g.organization.id == 1 %}
                                <div class="badge badge-primary"> {{ g.organization.name }}</div>
                            {% elif g.organization.id == 2 %}
                                <div class="badge badge-warning"> {{ g.organization.name }}</div>
                            {% elif g.organization.id == 3 %}
                                <div class="badge badge-success"> {{ g.organization.name }}</div>
                            {% elif g.organization.id == 4 %}
                                <div class="badge badge-danger"> {{ g.organization.name }}</div>

                            {% elif g.organization.id == 5 %}
                                <div class="badge badge-danger"> {{ g.organization.name }}</div>

                            {% elif g.organization.id == 6 %}
                                <div class="badge badge-danger"> {{ g.organization.name }}</div>
                            {% elif g.organization.id == 7 %}
                                <div class="badge badge-secondary"> {{ g.organization.name }}</div>
                            {% elif g.organization.id >= 8 %}
                                <div class="badge badge-light"> {{ g.organization.name }}</div>
                            {% endif %}

                                {% if g.foryat > 1 %}
                                    <div class="badge badge-warning blinking"> {% if g.foryat == 2 %}
                                        فوری {% elif g.foryat == 3 %}آنی{% endif %}</div>
                                {% endif %}

                        </span>
                        </td>
                        {% if request.user.owner.zoner or request.user.owner.arear %}
                            <td>{% if request.user.owner.zoner %} {{ g.gs.area.zone.name }}{% endif %}
                                {% if request.user.owner.zoner and request.user.owner.arear %}
                                    <hr style="border: #0c5460 1px dashed"> {% endif %}
                                {% if request.user.owner.arear %}{{ g.gs.area.name }}{% endif %} </td>
                        {% endif %}
                        {% if request.user.owner.gsid or request.user.owner.gsname %}
                            <td>{% if request.user.owner.gsid %} {{ g.gs.gsid }}{% endif %}
                                {% if request.user.owner.gsid and request.user.owner.gsname %}
                                    <hr style="border: #0c5460 1px dashed">{% endif %}
                                {% if request.user.owner.gsname %}
                                    <div>{{ g.gs.name }}</div>{% endif %}
                            </td>
                        {% endif %}
                        {% if request.user.owner.nazel or request.user.owner.product %}
                            <td>{% if request.user.owner.nazel %} {{ g.Pump.number }}{% endif %}
                                {% if request.user.owner.nazel and request.user.owner.product %}
                                    <hr style="border: #0c5460 1px dashed">{% endif %}
                                {% if request.user.owner.product %} {{ g.Pump.product.name }}{% endif %}
                            </td>
                        {% endif %}

                        {% if request.user.owner.createtime %}
                            <td>{{ g.pdate }}
                                <hr style="border: #0c5460 1px dashed">
                                {{ g.ptime }}</td>
                        {% endif %}
                        {% if request.user.owner.creator %}
                            <td>{{ g.owner.first_name }} {{ g.owner.last_name }}</td>
                        {% endif %}


                    </tr>
                {% endfor %}
            {% endif %}
            {% if request.user.owner.viewtickets == 2 %}
                <tr>
                    <th scope="col">پیگیری</th>

                    {% if request.user.owner.shomare %}
                        <th scope="col">شماره تیکت</th>{% endif %}
                    {% if request.user.owner.sarfasl or request.user.owner.onvan %}
                        <th scope="col">شرح خرابی</th>
                    {% elif request.user.owner.sarfasl == False and request.user.owner.onvan == False %}
                        <th scope="col">واحد اقدام</th>{% endif %}
                    {% if request.user.owner.zoner and request.user.owner.arear %}
                        <th scope="col">منطقه</th>
                    {% elif request.user.owner.zoner == False and request.user.owner.arear %}
                        <th scope="col">ناحیه</th>
                    {% elif request.user.owner.zoner and request.user.owner.arear == False %}
                        <th scope="col">منطقه</th>{% endif %}

                    {% if request.user.owner.gsid or request.user.owner.gsname %}
                        <th scope="col"> جایگاه</th>{% endif %}
                    {% if request.user.owner.nazel or request.user.owner.product %}
                        <th scope="col">نازل</th>{% endif %}
                    {% if request.user.owner.createtime %}
                        <th scope="col">تاریخ ایجاد</th>{% endif %}
                    {% if request.user.owner.creator %}
                        <th scope="col">ثبت کننده</th>{% endif %}


                </tr>
                </thead>
                <tbody>
                {% for g in list %}
                    <tr id="tr{{ g.id }}">
                        <td>
                            <ul class="nav">
                                <li class="nav-item">
                                    <button style="color: #f6fdf7"
                                            onclick="getticket({{ g.id }},1,{{ request.user.owner.role.id }},'{{ g.rnd }}')"
                                            class="btn nav-link bg-secondary-bright"
                                            title={% if g.gs.status_id == 1 %}"بررسی تیکت" {% else %}
                                                {{ g.gs.status.name }} {% endif %} data-toggle="modal"
                                            data-target="#workflowModal">
                                        {% if g.gs.status_id != 1 %}
                                            <i data-feather="eye-off" aria-hidden="true"></i>
                                        {% else %}
                                            {% if request.user.owner.role.role in 'test,fani' %}


                                                {% if g.islock %}
                                                    <i data-feather="lock" aria-hidden="true"></i>
                                                {% else %}
                                                    <i data-feather="eye" aria-hidden="true"></i>

                                                {% endif %}

                                            {% else %}
                                                <i data-feather="eye" aria-hidden="true"></i>
                                            {% endif %}
                                        {% endif %}

                                    </button>
                                    {% if request.user.owner.role.role == 'tek' %}
                                        <button style="background: #e3c2f3" onclick="runerjatotek({{ g.id }})"
                                                class="btn btn-apple" title="انتقال تیکت به تکنسین دیگر"
                                                data-toggle="modal"
                                                data-target="#erjatotek">
                                            <i data-feather="send" aria-hidden="true"></i>
                                        </button>
                                    {% endif %}

                                    {% if g.failure.isnazel or g.failure.enname == 'rack' %}
                                        <button style="background: #a8f1b2" onclick="runlock({{ g.id }},'{{ g.rnd }}')"
                                                class="btn btn-apple" title="ثبت پلمپ" data-toggle="modal"
                                                data-target="#plomp">
                                            <i data-feather="key" aria-hidden="true"></i>
                                        </button>
                                    {% endif %}

                                </li>
                            </ul>
                        </td>
                        {% if request.user.owner.shomare %}
                            <td><small id="tofailur{{ g.id }}"><span class="badge badge-light">{{ g.id }}</span></small>
                            </td>{% endif %}
                        <td><small id="tofailur{{ g.id }}">{% if request.user.owner.sarfasl %}
                            {{ g.failure.failurecategory.info }} {% endif %}{% if request.user.owner.sarfasl %}
                            {{ g.failure.info }}{% endif %}</small>


                            <span id="tofw{{ g.id }}">

                            {% if g.organization.id == 1 %}
                                <div class="badge badge-primary"> {{ g.organization.name }}</div>
                            {% elif g.organization.id == 2 %}
                                <div class="badge badge-warning"> {{ g.organization.name }}</div>
                            {% elif g.organization.id == 3 %}
                                <div class="badge badge-success"> {{ g.organization.name }}</div>
                            {% elif g.organization.id == 4 %}
                                <div class="badge badge-danger"> {{ g.organization.name }}</div>
                            {% elif g.organization.id == 5 %}
                                <div class="badge badge-danger"> {{ g.organization.name }}</div>
                            {% elif g.organization.id == 6 %}
                                <div class="badge badge-danger"> {{ g.organization.name }}</div>
                            {% elif g.organization.id == 7 %}
                                <div class="badge badge-secondary"> {{ g.organization.name }}</div>
                            {% elif g.organization.id == 8 %}
                                <div class="badge badge-light"> {{ g.organization.name }}</div>
                            {% else %}
                                <div class="badge badge-light"> {{ g.organization.name }}</div>
                            {% endif %}

                                {% if g.foryat > 1 %}
                                    <div class="badge badge-warning"> {% if g.foryat == 2 %}
                                        فوری {% elif g.foryat == 3 %}آنی{% endif %}</div>
                                {% endif %}

                        </span>
                        </td>
                        {% if request.user.owner.zoner or  request.user.owner.arear %}
                            <td> {% if request.user.owner.zoner %} {{ g.gs.area.zone.name }} {% endif %}
                                {% if request.user.owner.arear %}
                                    {% if request.user.owner.zoner and  request.user.owner.arear %} | {% endif %}
                                    {{ g.gs.area.name }}{% endif %}</td>
                        {% endif %}
                        {% if request.user.owner.gsid or  request.user.owner.gsname %}
                            <td>{% if request.user.owner.gsid %}<h6>{{ g.gs.gsid }}</h6> {% endif %}
                                {% if request.user.owner.gsname %}{{ g.gs.name }} {% endif %}</td>
                        {% endif %}
                        {% if request.user.owner.nazel %}
                            <td> <span {% if g.Pump.product_id == 2 %}class="badge badge-danger" {% endif %}
                                    {% if g.Pump.product_id == 3 %} class="badge badge-success" {% endif %}
                                    {% if g.Pump.product_id == 4 %}
                                       class="badge badge-warning" {% endif %}><h6>{{ g.Pump.number }}</h6>
                </span>
                            </td>
                        {% endif %}
                        {% if request.user.owner.createtime %}
                            <td>{{ g.pdate }}/{{ g.ptime }}</td>{% endif %}
                        {% if request.user.owner.creator %}
                            <td>{{ g.owner.first_name }} {{ g.owner.last_name }}</td>{% endif %}
                    </tr>
                {% endfor %}
            {% endif %}
            </tfoot>
        </table>
    </div>
    {% include 'ticket/paginator.html' %}
    <input id="ticketId" type="hidden" value="">
    <input id="ischangemasterid" type="hidden" value="">
    <input id="ischangepinpadid" type="hidden" value="">

    <div class="modal fade" id="workflowModal" tabindex="-1" role="dialog" aria-hidden="true" data-keyboard="false"
         data-backdrop="static">

    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">

            <div id="headerid" class="modal-header">


            </div>
            <div class="modal-body">
                <div class="text-left" id="fotterid2">
                    {% if request.user.owner.role.id == 7 or request.user.owner.role.id == 8 %}
                        <div class="form-group">
                            <div class="custom-control custom-switch custom-checkbox-warning">
                                <input onclick="locked()" type="checkbox" class="custom-control-input"
                                       id="customSwitch5">
                                <label class="custom-control-label" for="customSwitch5">این تیکت در اختیار من
                                    است</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="custom-control custom-switch custom-checkbox-warning">
                                <input type="checkbox" class="custom-control-input"
                                       id="sms">
                                <label class="custom-control-label" for="sms">متن شرح اقدام به تکنسین پیامک گردد</label>
                            </div>
                        </div>

                        </div>
                        <hr>
                    {% endif %}


                <div id="gsidid"></div>


                <hr>
                <div id="ListTicketId">


                </div>
            </div>

            <div class="modal-footer">


                <div id="fotterid">
                    {% if formpermmision.t_open != 'view' %}
                        <ul class="nav">
                            <li class="nav-item">
                                <button style="display: block" id="forwardid" type="button"
                                        class="btn btn-outline-warning">
                                    <i data-feather="corner-up-right" aria-hidden="true"></i>ارجاع
                                </button>
                            </li>
                        </ul>
                        <input type="hidden" id="parametr_id">
                        <div class="modal fade" id="editMenu" tabindex="-1" role="dialog" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalCenterTitle">ویرایش عناوین</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <i class="ti-close" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <p>انتخاب</p>
                                        <select class="form-control" name="item_info" id="item_info">

                                        </select>
                                    </div>
                                    <div class="modal-footer">
                                        <button id="closebtnmodal" type="button" class="btn btn-secondary"
                                                data-dismiss="modal">بستن
                                        </button>
                                        <button onclick="updateItem({{ gs.id }})" type="button" class="btn btn-primary"
                                                data-dismiss="modal">ذخیره تغییرات
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <ul class="nav">
                            <li class="nav-item">
                                <button id="checkid" onclick="getok()" type="button"
                                        class="btn btn-outline-success btn-pulse">
                                    <i data-feather="check" aria-hidden="true"></i> رسیدگی
                                </button>
                            </li>
                        </ul>
                    {% endif %}
                    <button id="closebtnmodal" type="button" class="btn btn-secondary" data-dismiss="modal">بستن
                    </button>
                </div>
            </div>
        </div>
    </div>





    <div class="modal fade" id="ChangeFailure" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
    <div id="headerid" class="modal-header">


    </div>
    <div class="modal-body">

        <div class="col-md-12 mb-12 col-sm-12">
            <div class="form-group">


            </div>

            <div id="showNazel" style="display: none" class="col-md-12 mb-12 col-sm-12">
                <div class="form-group">
                    <label for="validationCustom02">نازل</label>
                    <select id="id_Pump" name="Pump" class="form-control form-control-bg">

                        {% for role in zone %}
                            <option value="{{ role.id }}">{{ role.name }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <div id="fotterid">
                <ul class="nav">
                    <li class="nav-item">
                        <button type="button" class="btn btn-outline-warning btn-pulse">
                            <i data-feather="corner-up-right" aria-hidden="true"></i> ثبت
                        </button>
                    </li>
                </ul>

                <button type="button" class="btn btn-secondary" data-dismiss="modal">بستن</button>
            </div>
        </div>
    </div>




{% endblock %}
{% block script %}
    <script src="{% static 'assets/js/examples/datatable.js' %}"></script>
    {#    <script src="{% static 'vendors/dataTable/jquery.dataTables.min.js' %}"></script>#}
    <script src="{% static 'vendors/select2/js/select2.min.js' %}"></script>
    <!-- Bootstrap 4 and responsive compatibility -->
    <script src="{% static 'vendors/dataTable/dataTables.bootstrap4.min.js' %}"></script>
    <script src="{% static 'vendors/dataTable/dataTables.responsive.min.js' %}"></script>

    {% include 'mainscript.html' %}



    <script>


        $('.select2-example').select2({
            placeholder: 'Select',
            allowClear: true
        });
        $('.select3-example').select2({
            placeholder: 'Select'
        });
        $('.select4-example').select2({
            placeholder: 'Select'
        });
        $('.select5-example').select2({
            placeholder: 'Select'
        });
        $('.select6-example').select2({
            placeholder: 'Select'
        });
        $('.select7-example').select2({
            placeholder: 'Select'
        });

        function getFilter() {
            document.getElementById('FilterCard').style.display = "block";
        }

        function FilterCardClose() {
            document.getElementById('FilterCard').style.display = "none";
        }

        function FilterCardCloseform() {
            document.getElementById('FilterCard').style.display = "none";
        }

        function locked() {
            if (document.getElementById('customSwitch5').checked) {
                lockedrow(1)
            } else {
                lockedrow(2)
            }

        }

        $(document).ready(function () {
            var box = document.getElementById('responsive');
            box.removeAttribute('style');
            box.style.width = null;

            {% if request.user.owner.role.role == 'tek' %}
                document.getElementById("id_ownerrole").value = "0"
                navigator.geolocation.getCurrentPosition(showPsition);
            {% else %}
                document.getElementById("id_ownerrole").value = "1"
            {% endif %}
            GetArea()
        });

        function getticket(a, b, c, d) {

            {% if request.user.owner.role.role == 'tek' %}
                document.getElementById("id_ownerrole").value = "0"
                navigator.geolocation.getCurrentPosition(showPsition);
            {% else %}
                document.getElementById("id_ownerrole").value = "1"
            {% endif %}

            Getwork(a, b, c, d)
        }

        function showPsition(p) {
            var lat = p.coords.latitude;
            var long = p.coords.longitude;

            document.getElementById("id_latid").value = lat.toPrecision(8);
            document.getElementById("id_lngid").value = long.toPrecision(8);
            if (lat) {
                {#document.getElementById("addbtn").style.display= "block"#}
                {#document.getElementById("addbtn").type = 'submit';#}
                {#document.getElementById("shmsg").style.visibility = "hidden"#}

            } else {
                alert("سیستم قادر به دریافت مشخصات لوکیشن شما نمی باشد امکان ثبت وجود ندارد");
            }


        }

        function addpolomp() {
            var serial = document.getElementById('id_polomp').value;

            var content = '';
            content += '<tr id="' + 1 + '">';
            content += '<td class="text-primary" id="serial">' + serial + '</td></tr>';


            $('#tblList tbody').append(content);
        }

        function fakpolomp() {
            var serial = document.getElementById('id_fak').value;

            var content = '';
            content += '<tr id="' + 1 + '">';
            content += '<td class="text-danger" id="serial">' + serial + '</td></tr>';


            $('#tblList2 tbody').append(content);
        }


    </script>
{% endblock %}